<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-06-10 gio 16:19 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Digital Forensics and Cybercrime</title>
<meta name="author" content="Tancredi Covioli" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="css/dfc-notes.css" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Digital Forensics and Cybercrime</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org48818f0">Cybercryme Landscape</a>
<ul>
<li><a href="#orgdd0ea0c">Threat dimensions</a></li>
<li><a href="#orgdb9183d">Gartner quadrant of threats</a></li>
<li><a href="#orgd9b28d4">Internal threats</a></li>
<li><a href="#org21c0b92">How to manage a cyber attack</a></li>
<li><a href="#org2f37194">Financially oriented attacks</a></li>
<li><a href="#org016325a">Cybercrime</a>
<ul>
<li><a href="#org890d8e8">Identity theft</a></li>
<li><a href="#org06af13b">Selling kits</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org900b267">Abuses of cryptocurrency and forensics</a>
<ul>
<li><a href="#org38998a7">Some informations</a>
<ul>
<li><a href="#org8ae1905">Bitcoin wallet</a></li>
<li><a href="#org833662a">Bitcoin address</a></li>
<li><a href="#org20cd96b">Bitcoin mining</a></li>
<li><a href="#org6c0a4fc">Forks</a></li>
</ul>
</li>
<li><a href="#orgdda91bb">Pseudo Anonimity</a>
<ul>
<li><a href="#orga84f42c">How to protect Pseudo Anonimity</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgb0ed191">Introduction to Digital Forensics</a>
<ul>
<li><a href="#orgb9fc5d5">Witnesses vs experts</a></li>
<li><a href="#org1d1363b">Daubert Standard (How to be an Expert Witness)</a>
<ul>
<li><a href="#orgd788389">Scientific Method</a></li>
<li><a href="#orgfb0733f">Scientific Test for Daubert</a></li>
<li><a href="#org62a9a2b">Four phases of investigation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org8edcb11">Acquisition</a>
<ul>
<li><a href="#org35c8baa">Acquisition in Italy</a></li>
<li><a href="#orgc67d467">Brittleness of digital evidence</a>
<ul>
<li><a href="#orgb12d140">Hashes</a></li>
</ul>
</li>
<li><a href="#org491cf0d">Typical hw/sw for acquisition</a></li>
<li><a href="#orgd315e28">Bitstream images</a></li>
<li><a href="#org8a8636f">Acquisition procedure</a>
<ul>
<li><a href="#orgedddb98">The time problem</a></li>
<li><a href="#org6782a10">The size problem</a></li>
<li><a href="#org6ac2a37">The encryption problem</a></li>
</ul>
</li>
<li><a href="#org598e97c">Forensics Duplicators</a></li>
</ul>
</li>
<li><a href="#orgf7e6066">Identification</a>
<ul>
<li><a href="#org382b31f">Setup</a>
<ul>
<li><a href="#orgcc82deb">Why not windows</a></li>
<li><a href="#org37771ef">Repeatibility</a>
<ul>
<li><a href="#org4d2aab8">Law enforcement tools</a></li>
</ul>
</li>
<li><a href="#org0366966">What analysis encompasses</a></li>
</ul>
</li>
<li><a href="#org8a99faa">Data Recovery</a>
<ul>
<li><a href="#org876292d">Disk Geometry</a></li>
<li><a href="#org0f7d950">File system</a></li>
<li><a href="#orgfdf5900">Carving</a></li>
</ul>
</li>
<li><a href="#org1f3e89c">Antiforensic Techniques</a>
<ul>
<li><a href="#orgbba61f7">Timeline tampering</a></li>
<li><a href="#orge690b4c">Countering file recovery</a></li>
<li><a href="#org55ad53a">Fileless attacks</a></li>
<li><a href="#org969ef0c">Filesystem insertion and subversion technologies</a></li>
<li><a href="#orgc9e0ff2">Log analisys and tampering</a></li>
<li><a href="#org4dc34f4">Patition table analisys</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2dbfc42">SSD-forensics</a>
<ul>
<li><a href="#org663cb6d">FTL</a></li>
<li><a href="#org15623f1">Tests</a>
<ul>
<li><a href="#orgce484fb">Trimming</a></li>
<li><a href="#org9989500">Garbage Collection</a></li>
<li><a href="#orgd5cca5d">Erasing patterns</a></li>
<li><a href="#org9616c24">Compression</a></li>
<li><a href="#orgde6e2fe">Wear Leveling</a></li>
<li><a href="#orgd0311d4">Reults on file recoverability</a></li>
</ul>
</li>
<li><a href="#orgd652301">Conclusions</a></li>
</ul>
</li>
<li><a href="#orgcdedf95">Evaluation and presentation</a>
<ul>
<li><a href="#orgc05a852">Evaluation phase</a>
<ul>
<li><a href="#org7a51d89">Analyzing the documents</a></li>
</ul>
</li>
<li><a href="#orgb8fdc23">The relationship with lawyers, customers and prosecutor/police</a></li>
<li><a href="#orgc0bd651">Typical errors found in reports and analyses and presentation errors</a>
<ul>
<li><a href="#org00381d3">What to look for</a></li>
<li><a href="#org5099aa3">What to do when your client is in the wrong</a></li>
<li><a href="#org4024a6f">Writing your report</a></li>
<li><a href="#org09cbe80">Structure of a report</a></li>
</ul>
</li>
<li><a href="#orgc8c512d">Testimony as a witness</a></li>
<li><a href="#org537b31d">Direct and cross examination</a></li>
</ul>
</li>
<li><a href="#orgf0f63a7">Fraud analysis and detection (carminati, 16/04/21)</a>
<ul>
<li><a href="#org2fe1c96">Why people commit fraud</a></li>
<li><a href="#org9c53254">Fraud categories</a></li>
<li><a href="#org1e340c1">Anti-fraud stategies</a>
<ul>
<li><a href="#org0e549b4">Anti fraud mechanisms</a></li>
<li><a href="#orga13c288">Fraud detection and Fraud prevention</a>
<ul>
<li><a href="#org9d1ff89">Example of fraud prevention: Strong customer authentication</a></li>
</ul>
</li>
<li><a href="#org425cd4c">Strategies for Fraud detection and prevention</a>
<ul>
<li><a href="#orga07b884">Expert-based approach</a>
<ul>
<li><a href="#orgb4d7c59">Rule based engines</a></li>
</ul>
</li>
<li><a href="#org20cab3a">Automated fraud detection system</a></li>
<li><a href="#org6a65376">Data driven fraud detection</a></li>
</ul>
</li>
<li><a href="#org46ba359">Fraud management</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgdaa1b24">Fraud Detection (carminati, 21/04/21)</a>
<ul>
<li><a href="#org3c5c671">Frauds as a dynamic phenomenon</a></li>
<li><a href="#org33763c8">Techniques to detect a fraud automatically</a>
<ul>
<li><a href="#org1e178dc">Unsupervised learning analytics techniques</a>
<ul>
<li><a href="#org4cbd815">Telecommunication example</a></li>
<li><a href="#org4a04c57">Limitations</a></li>
</ul>
</li>
<li><a href="#org9720032">Supervised learning techniques</a>
<ul>
<li><a href="#org8b3ce94">Limitations</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3610a85">Developing a fraud detection system</a></li>
<li><a href="#org1507773">Social Network Analysis</a></li>
<li><a href="#org5318ee2">Fraud management cycle</a>
<ul>
<li><a href="#org666446a">Regular update of the model</a>
<ul>
<li><a href="#org1746190">Reinforcement learning</a></li>
</ul>
</li>
<li><a href="#org93f353f">Example: Credit card fraud</a></li>
</ul>
</li>
<li><a href="#orgef7482f">Fraud analytical process</a>
<ul>
<li><a href="#org72bf761">Preprocessing</a></li>
<li><a href="#org178a87b">Analytics</a>
<ul>
<li><a href="#orgc5c2f8f">Possible analysis outputs</a></li>
</ul>
</li>
<li><a href="#org54fe09f">Post processing phase</a></li>
<li><a href="#orgee88c2c">Key characteristics of successful fraud analtics models</a></li>
<li><a href="#org09c42f1">Fraud management as risk management</a>
<ul>
<li><a href="#orge0865de">Economical cost</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org6845c2f">Challenges of developing fraud-detection models</a></li>
<li><a href="#org8ce00fa">Red flags of frauds</a></li>
</ul>
</li>
<li><a href="#org341eabd">Machine Learning for Fraud Detection</a>
<ul>
<li><a href="#org2f7ba4a">Notice</a></li>
<li><a href="#orgf1586b0">Data preprocessing</a>
<ul>
<li><a href="#org992b2c4">Real data problems</a></li>
<li><a href="#org8ca822a">Types of sources</a>
<ul>
<li><a href="#org77c5eed">Transactional Data</a></li>
</ul>
</li>
<li><a href="#orgdfa025d">Types of data elements</a></li>
<li><a href="#org2f6237a">Sampling</a>
<ul>
<li><a href="#org13b8dcd">Bias example</a></li>
<li><a href="#orgc61c59a">Stratified sampling</a></li>
</ul>
</li>
<li><a href="#orgc8ae4af">Visual data exploration</a></li>
<li><a href="#orge4a5922">Exploratory statistical Analysis</a></li>
<li><a href="#org44c46fe">Dealing with missing values</a></li>
<li><a href="#org07559e5">Outliers</a>
<ul>
<li><a href="#orgc686a14">Outlier treatment</a></li>
</ul>
</li>
<li><a href="#org0afc3a5">When invalid data is not outlying</a></li>
<li><a href="#orgd1fc295">Conclusion on outliers and invalid values</a></li>
<li><a href="#org8e96c68">Standardization</a></li>
<li><a href="#orge989b3a">Categorization</a></li>
<li><a href="#org9a2e50c">Variable Selection</a>
<ul>
<li><a href="#orgc27d10d">Filters</a></li>
<li><a href="#orgb18891b">Wrapper</a></li>
<li><a href="#orgfe7bb3b">Principal Components Analysis</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf1619e2">Descriptive analytics for fraud detection</a>
<ul>
<li><a href="#org7d21bd3">Relevant environments for Unsupervised learning</a></li>
<li><a href="#org6585c44">Defining the norm</a></li>
<li><a href="#org80be186">Graphical outliers detection</a></li>
<li><a href="#org40ed15e">Statistical outliers detection</a>
<ul>
<li><a href="#orgf62f5f4">Break point analysis</a></li>
<li><a href="#org7da4a6b">Peer Group analysis</a>
<ul>
<li><a href="#org9d3a70b">Identifying, sizing and comparing a peer group</a></li>
</ul>
</li>
<li><a href="#org4081a3b">Break point analysis vs peer group analysis</a></li>
<li><a href="#orgbef104f">Association rule analysis</a>
<ul>
<li><a href="#org68aa82d">Support</a></li>
<li><a href="#orgd90c7ab">Confidence</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2f4dae1">Clustering</a>
<ul>
<li><a href="#orgd8789c3">Kinds of clusters</a></li>
<li><a href="#org7c30754">Measure the similarity of elements</a></li>
<li><a href="#orgdbd92e0">Hierarchical clustering</a>
<ul>
<li><a href="#orgf7d1174">Distance between clusters</a></li>
<li><a href="#orga635627">Select the number of clusters</a></li>
<li><a href="#orgf2aa98a">Advantages and disadvantages</a></li>
</ul>
</li>
<li><a href="#orgfdf4f51">Nonhierarchical clustering</a>
<ul>
<li><a href="#org633b108">k-means</a></li>
<li><a href="#orgf06e9eb">Self organizing maps</a></li>
</ul>
</li>
<li><a href="#org5dab944">Semi-Supervised clustering</a></li>
<li><a href="#orgd51365c">One-class SVM</a></li>
<li><a href="#orgb3124c8">Evaluation of clustering solutions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org16a44fc">Predictive analytics for fraud detection</a>
<ul>
<li><a href="#orgb9ee66b">Linear regression</a></li>
<li><a href="#org35c2369">Logistic regression</a></li>
<li><a href="#org6e4bb52">Decision trees</a>
<ul>
<li><a href="#orgc88faf2">Splitting decision</a></li>
<li><a href="#org9cc86fb">Stopping decision</a></li>
<li><a href="#org87958c2">Advantages</a></li>
<li><a href="#org7d8e495">Disadvantages</a></li>
</ul>
</li>
<li><a href="#org921b1bb">Regression trees</a></li>
<li><a href="#org6264979">Neural Networks</a>
<ul>
<li><a href="#orgc3185df">Layers</a></li>
<li><a href="#orgceb5d74">Weigth learning</a></li>
<li><a href="#org533f322">How many hidden neurons?</a></li>
<li><a href="#orgd2bb1ab">The overfitting problem</a></li>
<li><a href="#org9863f7c">Neural Networks lack interpretability</a>
<ul>
<li><a href="#org40d1be3">Variable selection in Neural Networks</a></li>
<li><a href="#orgb01c337">Extracting rules from Neural Networks</a></li>
</ul>
</li>
<li><a href="#org2c24d1c">Two stage model setup</a></li>
</ul>
</li>
<li><a href="#org8868c33">Support Vector Machines</a>
<ul>
<li><a href="#orga0ebaa7">Benefits</a></li>
<li><a href="#org15a1eef">Problem</a></li>
<li><a href="#orgf287551">Rule extraction and Variable selection</a></li>
</ul>
</li>
<li><a href="#orgec2b226">Ensemble methods</a>
<ul>
<li><a href="#orgbcbfa5f">Bagging</a></li>
<li><a href="#orgf85c5af">Boosting</a></li>
<li><a href="#orge707e1d">Random Forest&#xa0;&#xa0;&#xa0;<span class="tag"><span class="missing_informations">missing_informations</span></span></a></li>
</ul>
</li>
<li><a href="#org94faf77">Evaluating a fraud detection model</a>
<ul>
<li><a href="#org4e593d3">Splitting the data set</a>
<ul>
<li><a href="#org248f6f1">Small data sets</a></li>
</ul>
</li>
<li><a href="#orgc3cdf70">Performance metrics</a></li>
<li><a href="#org0889f26">Managing skewed datasets</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#org212c2fc">Mobile Forensics&#xa0;&#xa0;&#xa0;<span class="tag"><span class="guest_lecture">guest_lecture</span></span></a>
<ul>
<li><a href="#orgab8ff45">Forensical soundness</a>
<ul>
<li><a href="#org8db5431">Low Level Exploits</a></li>
<li><a href="#orgf9eee11">Documentation is key</a></li>
</ul>
</li>
<li><a href="#org13ed2b0">Challenges of mobile forensics</a></li>
<li><a href="#orgd72be38">Operating system diversity</a>
<ul>
<li><a href="#orga93b43d">Android versions diversity</a></li>
<li><a href="#org97f4484">iOS versions diversity</a></li>
</ul>
</li>
<li><a href="#org89e0b59">Guidelines to follow</a>
<ul>
<li><a href="#org743e366">Evidence collection and preservation</a>
<ul>
<li><a href="#org99a4df6">Preparation</a></li>
<li><a href="#orgf57064c">Documentation</a></li>
<li><a href="#org08f44aa">What to do first</a></li>
<li><a href="#orgb1da896">Check periferals</a></li>
</ul>
</li>
<li><a href="#org5de243a">Evidence Handling</a>
<ul>
<li><a href="#orgd61523a">Access devices</a></li>
<li><a href="#orgd0ad772">Devices powered on and unlocked</a></li>
<li><a href="#orgba86c40">Encryption</a></li>
<li><a href="#org0bcb48e">Network Isolation</a></li>
</ul>
</li>
<li><a href="#org3985924">Evidence acquisition</a>
<ul>
<li><a href="#orgd92f4d5">Preparation</a>
<ul>
<li><a href="#org1bb6f45">Tools for law enforcement and acquisition services</a></li>
</ul>
</li>
<li><a href="#orgc6be27e">Device identification</a></li>
<li><a href="#orgc102d81">Extraction methods</a>
<ul>
<li><a href="#org6f01326">Physical acquisition</a></li>
<li><a href="#org1436dc1">Logical acquisition</a></li>
<li><a href="#org12c1b57">Partial filesystem aquisition</a></li>
<li><a href="#orgcc67a50">Invasive acquisition</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#org055ad08">Tool analysis: Autopsy</a>
<ul>
<li><a href="#orgf78e87e">Android analysis on Autopsy</a>
<ul>
<li><a href="#org8598cd2">Image extraction</a></li>
<li><a href="#org8d77297">Image Analysis</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgcfe8226">Android analysis with Physical analyzer (commercial tool)</a>
<ul>
<li><a href="#orga73ef8a">How to have a forensically resiliant phone&#xa0;&#xa0;&#xa0;<span class="tag"><span class="in_class_question">in_class_question</span></span></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org4757802">Malware Analysis&#xa0;&#xa0;&#xa0;<span class="tag"><span class="missing_informations">missing_informations</span>&#xa0;<span class="guest_lecture">guest_lecture</span></span></a></li>
</ul>
</div>
</div>
<div id="outline-container-org48818f0" class="outline-2">
<h2 id="org48818f0">Cybercryme Landscape</h2>
<div class="outline-text-2" id="text-org48818f0">
<p>
<b>Risks</b> are a statistical evaluation of the exposure to damage because of the presence of vulnerabilities and threats.<br />
</p>
</div>
<div id="outline-container-orgdd0ea0c" class="outline-3">
<h3 id="orgdd0ea0c">Threat dimensions</h3>
<div class="outline-text-3" id="text-orgdd0ea0c">
<p>
Threats can be<br />
</p>
<ul class="org-ul">
<li><b>Generic</b> or <b>Targeted</b>:<br />
<ul class="org-ul">
<li>Generic threats are threats in which we incur for simply being connected to the internet.<br /></li>
<li>Targeted threats are threats that exploit known informations about us.<br /></li>
</ul></li>
<li>Financially or non <b>financially motivated</b>:<br />
<ul class="org-ul">
<li>Financially motivated threats are easy to understand.<br /></li>
<li>Non financially motivated threats can be difficult to understand<br /></li>
</ul></li>
<li><b>Internal</b> or <b>External</b>:<br />
<ul class="org-ul">
<li>Internal threats are put up by some internal figure of the organization itself.<br /></li>
<li>External threats are put up by external figures (like criminals and other organizations).<br /></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgdb9183d" class="outline-3">
<h3 id="orgdb9183d">Gartner quadrant of threats</h3>
<div class="outline-text-3" id="text-orgdb9183d">
<p>
A table showing some example of the threat categories listed above, with their relative possible financiary motivation level.<br />
</p>
</div>
</div>
<div id="outline-container-orgd9b28d4" class="outline-3">
<h3 id="orgd9b28d4">Internal threats</h3>
<div class="outline-text-3" id="text-orgd9b28d4">
<p>
Internal threats can be countered by contracts and <span class="underline">separation of duties</span>.<br />
They can be of various kind:<br />
</p>
<ul class="org-ul">
<li>Malicious insiders (personal gain)<br /></li>
<li>Inside agents (other organizations)<br /></li>
<li>Emotional employees (revenge)<br /></li>
<li>Reckless employees (self conciousness)<br /></li>
<li>Third party users (other organization&rsquo;s users)<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org21c0b92" class="outline-3">
<h3 id="org21c0b92">How to manage a cyber attack</h3>
<div class="outline-text-3" id="text-org21c0b92">
<p>
In cyberspace, private companies defend their own piece of infrastructure by themselves.<br />
When we talk about public or semi-public agencies (see ENI, VODAFONE etc.), what should they do in case of a big scale cyber-attack? Is the jurisdiction of the attack on them or on the nation?<br />
</p>

<p>
The NATO wrote an entire manual (the Tallin Manual) on the policy they think applies to confilcts in cyberspace.<br />
</p>
</div>
</div>
<div id="outline-container-org2f37194" class="outline-3">
<h3 id="org2f37194">Financially oriented attacks</h3>
<div class="outline-text-3" id="text-org2f37194">
<p>
The monetization of the attacks can be either direct or indirect.<br />
</p>
<ul class="org-ul">
<li>Direct monetization: credit card / bank account fraud; ransomware; fake AVs.<br /></li>
<li>Indirect monetization: information gathering; abuse computing resources for other attacks; rent or sell botnets.<br /></li>
</ul>

<p>
The discriminant between the two is whether the money comes directly from the victim or from the use of their computer.<br />
</p>
</div>
</div>
<div id="outline-container-org016325a" class="outline-3">
<h3 id="org016325a">Cybercrime</h3>
<div class="outline-text-3" id="text-org016325a">
<p>
Cybercrime has its own ecosystem, whit producers, enablers (that don&rsquo;t produce the exploits but keep them relevant) and clients<br />
</p>
</div>
<div id="outline-container-org890d8e8" class="outline-4">
<h4 id="org890d8e8">Identity theft</h4>
<div class="outline-text-4" id="text-org890d8e8">
<p>
Identities are stolen because they can be abused.<br />
American SSN is sometimes abused for authentication purposes.<br />
</p>
</div>
</div>
<div id="outline-container-org06af13b" class="outline-4">
<h4 id="org06af13b">Selling kits</h4>
<div class="outline-text-4" id="text-org06af13b">
<p>
Various kinds of kits are sold in the cybercrime ecosystem:<br />
Botnets, exploitation kits, viruses..<br />
</p>

<p>
These are then used for other kinds of crimes.<br />
</p>

<p>
Also, the selling of stolen VISA accounts is common for money laundering and scamming (e.g: the scam of buying plane tickets and sell them to poor people before the real owner of the card blocks the payment).<br />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org900b267" class="outline-2">
<h2 id="org900b267">Abuses of cryptocurrency and forensics</h2>
<div class="outline-text-2" id="text-org900b267">
</div>

<div id="outline-container-org38998a7" class="outline-3">
<h3 id="org38998a7">Some informations</h3>
<div class="outline-text-3" id="text-org38998a7">
</div>
<div id="outline-container-org8ae1905" class="outline-4">
<h4 id="org8ae1905">Bitcoin wallet</h4>
<div class="outline-text-4" id="text-org8ae1905">
<ul class="org-ul">
<li>Manage and store keys of you bitcoin addresses<br /></li>
<li>Creates and signs transactions (receive/send BTC)<br /></li>
<li>Track the balance<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org833662a" class="outline-4">
<h4 id="org833662a">Bitcoin address</h4>
<div class="outline-text-4" id="text-org833662a">
<p>
String used to receive payments.<br />
You usually want to use more addresses to make people unable to track your movements.<br />
</p>
</div>
</div>

<div id="outline-container-org20cd96b" class="outline-4">
<h4 id="org20cd96b">Bitcoin mining</h4>
<div class="outline-text-4" id="text-org20cd96b">
<p>
&ldquo;Miners&rdquo; compete to solve a complex problem by bruteforce: find the next block of transactions with as much leading zeroes as possible.<br />
The one that resolves it first gets a reward (constantly decreasing).<br />
</p>
</div>
</div>

<div id="outline-container-org6c0a4fc" class="outline-4">
<h4 id="org6c0a4fc">Forks</h4>
<div class="outline-text-4" id="text-org6c0a4fc">
<p>
When two miners find the same solution at approximately the same time, each block becomes the new head of the blockchain for a network: the blockchain splits.<br />
That&rsquo;s what is called a fork.<br />
When other 6/7 blocks are found, we see which chain they continue and we consider that the &ldquo;real&rdquo; chain.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgdda91bb" class="outline-3">
<h3 id="orgdda91bb">Pseudo Anonimity</h3>
<div class="outline-text-3" id="text-orgdda91bb">
<p>
An identity can have an arbitrary number of addresses, which can be used to split a transaction into multiple ones and make the derivation of the real owner difficult.<br />
</p>

<p>
But all the transaction data is available, so if you take enough care you can track the flow of a transaction and infer some things:<br />
</p>
<ul class="org-ul">
<li>most of the times, all the inputs of a transaction are the same user.<br /></li>
<li>New addresses are usually shadow addresses, made explicitly to cover the traces.<br /></li>
</ul>
</div>

<div id="outline-container-orga84f42c" class="outline-4">
<h4 id="orga84f42c">How to protect Pseudo Anonimity</h4>
<div class="outline-text-4" id="text-orga84f42c">
<p>
The &ldquo;flow tracking&rdquo; described above is made difficult by malicious sites by mixing together multiple transactions from different clients. (See Silk Road, as an example).<br />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb0ed191" class="outline-2">
<h2 id="orgb0ed191">Introduction to Digital Forensics</h2>
<div class="outline-text-2" id="text-orgb0ed191">
<p>
Forensics: the application of scientific analysis methods to reconstruct evidence.<br />
</p>

<p>
Digital Forensics: the application of scientific analysis methods to computer systems/digital data/networks to reconstruct evidence.<br />
</p>
</div>

<div id="outline-container-orgb9fc5d5" class="outline-3">
<h3 id="orgb9fc5d5">Witnesses vs experts</h3>
<div class="outline-text-3" id="text-orgb9fc5d5">
<p>
<b>Witnesses</b> testify about <span class="underline">what they personally know</span>. They cannot testify about something they heard from others.<br />
<b>Experts</b> can <span class="underline">testify with their scientifical analysis</span> even if they where not present.<br />
</p>

<p>
Experts are witnesses with knowledge, skill, experience or education that can form an opinion.<br />
</p>
</div>
</div>

<div id="outline-container-org1d1363b" class="outline-3">
<h3 id="org1d1363b">Daubert Standard (How to be an Expert Witness)</h3>
<div class="outline-text-3" id="text-org1d1363b">
<p>
The <b>Daubert Standard</b> is a <span class="underline">rule of evidence</span> regarding the <span class="underline">admissibility of expert witness</span> testimonies in the U.S.<br />
</p>

<p>
In the states where the standard is applied, an expert must:<br />
</p>
<ul class="org-ul">
<li>have its specialized knowledge be helpful to the trier to understand the evidence<br /></li>
<li>have his/her testimony rely on sufficient facts/data<br /></li>
<li>have his/her testimony be <b>scientifically valid</b>:<br />
<ul class="org-ul">
<li>Must be the product of reliable principles and methods<br /></li>
<li>Such principles and methods must have been reliably applied<br /></li>
</ul></li>
</ul>
</div>

<div id="outline-container-orgd788389" class="outline-4">
<h4 id="orgd788389">Scientific Method</h4>
<div class="outline-text-4" id="text-orgd788389">
<p>
For a method to be scientific, it must be:<br />
</p>
<ul class="org-ul">
<li><b>Repeatable</b><br />
If the experiment cannot be repeated (e.g: blood drop analysis) it must be detailed enough to be understood fully.<br /></li>
<li><b>Falsifiable</b><br />
If the experiment cannot be confuted, it is not scientific (e.g: statistics cannot be considered scientific)<br /></li>
</ul>
</div>
</div>

<div id="outline-container-orgfb0733f" class="outline-4">
<h4 id="orgfb0733f">Scientific Test for Daubert</h4>
<div class="outline-text-4" id="text-orgfb0733f">
<p>
Factors to consider (not all of these must be simultaneously valid for the method to be considered scientific):<br />
</p>
<ul class="org-ul">
<li>Wheter the theory or the technique is accepted in the scientific community.<br /></li>
<li>Wheter it has been subjected to peer review.<br /></li>
<li>Wheter it has been tested (or can be).<br /></li>
<li>Wheter the rate of error is acceptable.<br /></li>
<li>Wheter the research was independent of the litigation<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>.<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org62a9a2b" class="outline-4">
<h4 id="org62a9a2b">Four phases of investigation</h4>
<div class="outline-text-4" id="text-org62a9a2b">
<p>
The four phases of an investigation are:<br />
</p>
<ol class="org-ol">
<li>The <b>acquisition</b> of the sources<br /></li>
<li>The <b>identification</b> of the evidences<br /></li>
<li>The <b>evaluation</b> of the evidences<br /></li>
<li>The <b>presentation</b> of the evidences<br /></li>
</ol>
</div>
</div>
</div>
</div>

<div id="outline-container-org8edcb11" class="outline-2">
<h2 id="org8edcb11">Acquisition</h2>
<div class="outline-text-2" id="text-org8edcb11">
</div>
<div id="outline-container-org35c8baa" class="outline-3">
<h3 id="org35c8baa">Acquisition in Italy</h3>
<div class="outline-text-3" id="text-org35c8baa">
<p>
In Italy, it is not requested to provide a report on how the acquisition was made, so the methods now presented will be overkill.<br />
</p>
</div>
</div>

<div id="outline-container-orgc67d467" class="outline-3">
<h3 id="orgc67d467">Brittleness of digital evidence</h3>
<div class="outline-text-3" id="text-orgc67d467">
<p>
All digital evidence, if modified, is not <b>tamper evident</b>, which means it can be modified without the modification being noticeable afterwards.<br />
There are, though, some procedure to ensure that digital evidence becomes tamper evident.<br />
</p>
</div>
<div id="outline-container-orgb12d140" class="outline-4">
<h4 id="orgb12d140">Hashes</h4>
<div class="outline-text-4" id="text-orgb12d140">
<p>
In court it is asked to prove that evidence hasn&rsquo;t been modified, and hashes allow you to validate that.<br />
Its <b>absence does not mean that the has been modified</b>.<br />
</p>

<p>
Remember that we create the hash so that we can create a record of how the evidence looks to be used later. This means that it <b>must be preserved in another location than the evidence</b> to ensure it has not been tampered with.<br />
</p>

<p>
They are not a dogma, and their absence won&rsquo;t be a huge obstacle for the &ldquo;jury&rdquo; to surpass.<br />
But they are useful to debunk any accusation of counterfation.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org491cf0d" class="outline-3">
<h3 id="org491cf0d">Typical hw/sw for acquisition</h3>
<div class="outline-text-3" id="text-org491cf0d">
<ul class="org-ul">
<li>Hardware:<br />
<ul class="org-ul">
<li>Write blocker<br /></li>
<li>external disks (simple copy through a live usb)<br /></li>
<li>removable HD enclosures<br /></li>
</ul></li>
<li>Operating system:<br />
<ul class="org-ul">
<li>Live linux distribution image<br /></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgd315e28" class="outline-3">
<h3 id="orgd315e28">Bitstream images</h3>
<div class="outline-text-3" id="text-orgd315e28">
<p>
Usually, by &ldquo;copying and pasting&rdquo; we lose some important informations.<br />
</p>

<p>
We can, instead, make a &ldquo;bit by bit&rdquo; clone <span class="underline">of the original media</span>.<br />
</p>

<p>
Of this image I want to make a hash, to ensure it&rsquo;s not tampered.<br />
</p>
</div>
</div>

<div id="outline-container-org8a8636f" class="outline-3">
<h3 id="org8a8636f">Acquisition procedure</h3>
<div class="outline-text-3" id="text-org8a8636f">
<ul class="org-ul">
<li>If possible, <b>disconnect the media</b><br />
<ul class="org-ul">
<li>Connect it to an analysis station, with a <b>write blocker</b> possibly (not a necessity, you can just confugure correctly your software).<br /></li>
<li>compute the hash of the source<br /></li>
<li>make a clone of the source and check its hash<br /></li>
</ul></li>
<li>When media <span class="underline">disconnection is not possible</span> (soldered memory / raid devices / other constraints)<br />
<ul class="org-ul">
<li><b>live boot the system</b> with a linux distribution (possibly one targeted to forensic analysis)<br />
<ul class="org-ul">
<li>only available if the target is off, though.<br />
When turning off the target, <span class="underline">pull the plug</span>. Don&rsquo;t let it have a system shutdown.<br /></li>
</ul></li>
<li>if the <span class="underline">target is powered on and cannot be turned off</span>, make sure first to take all the data available in the system, and <b>work in volatility order</b>:<br />
<ul class="org-ul">
<li><b>disconnect the machine from the network</b>, if the network is not necessary.<br />
Done to avoid additional modifications.<br /></li>
<li>dump the memory (In linux, there are /dev/mem and /dev/kmem that you may use to acquire the memory of the machine while on).<br /></li>
<li>save runtime informations (network, processes etc)<br /></li>
<li>make the disk acquisition<br /></li>
</ul></li>
</ul></li>
<li>When we think we caught the intruder, we might want to make the analysis &ldquo;live&rdquo;:<br />
<ul class="org-ul">
<li>check the logs (only usable if they are on a different machine than the one attacked)<br /></li>
<li>check the network traffic (now or never)<br /></li>
</ul></li>
</ul>

<p>
The noerror and sync options of dd are used to not make dd stop in case of errors in the device.<br />
</p>

<p>
The recomputation of the hash of the source and the acquisition image is made to ensure they are the same and that the source has not been modified (by comparing it with the first hash made of the device).<br />
</p>

<p>
We often use <b>multiple hashing algorithms</b> to compute the hash for the same image.<br />
The reason is that someone else who has analized before (or will analyze) the drive might have used a different hashing algorithm.<br />
</p>
</div>

<div id="outline-container-orgedddb98" class="outline-4">
<h4 id="orgedddb98">The time problem</h4>
<div class="outline-text-4" id="text-orgedddb98">
<p>
Computing the copy of a 1TB hdd/usb key might take some time depending on the interface used by the hdd itself or by the write blocker.<br />
It might take several ours to compute an hash and make a copy of the source.<br />
</p>

<p>
To avoid the time waste, some softwares may automate part of the procedure by computing the source hash while copyng.<br />
</p>
</div>
</div>

<div id="outline-container-org6782a10" class="outline-4">
<h4 id="org6782a10">The size problem</h4>
<div class="outline-text-4" id="text-org6782a10">
<p>
In large scale investigations (or when multiple investigations are held in parallel), the sizes of the drives might make storing their clones and transfering them a real burden.<br />
Using external media devices is a no-go, since it slows down operations by a lot if you don&rsquo;t use the correct interfaces (USB).<br />
</p>

<p>
NASs and SANs are used all the times for this specific reason.<br />
</p>
</div>
</div>

<div id="outline-container-org6ac2a37" class="outline-4">
<h4 id="org6ac2a37">The encryption problem</h4>
<div class="outline-text-4" id="text-org6ac2a37">
<p>
In Italy, it might not be required for the persecuted to provide the passcode to decrypt the evidence for the analysis, since it can be seen as <b>testifying against oneself</b>.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org598e97c" class="outline-3">
<h3 id="org598e97c">Forensics Duplicators</h3>
<div class="outline-text-3" id="text-org598e97c">
<p>
These perform the hashes and copy the hard drive into one of the others, printing a receipt with all the informations of the process.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgf7e6066" class="outline-2">
<h2 id="orgf7e6066">Identification</h2>
<div class="outline-text-2" id="text-orgf7e6066">
</div>

<div id="outline-container-org382b31f" class="outline-3">
<h3 id="org382b31f">Setup</h3>
<div class="outline-text-3" id="text-org382b31f">
<p>
The easyest operating system to work on when making forensic analisys is Linux, since it has/can:<br />
</p>
<ul class="org-ul">
<li>extensive native file system support<br /></li>
<li>native support for swapping drives<br /></li>
<li>mounting of disk images as drives<br /></li>
</ul>

<p>
On a linux guest we might keep some windows vms to use soe additional tools.<br />
</p>
</div>

<div id="outline-container-orgcc82deb" class="outline-4">
<h4 id="orgcc82deb">Why not windows</h4>
<div class="outline-text-4" id="text-orgcc82deb">
<p>
Windows tampers with drives and <b>modifies evidence</b>.<br />
It doesn&rsquo;t support many file systems.<br />
</p>

<p>
Remember: Some tools are windows only, and as such you cannot use linux for your entire job.<br />
When using these tools inside a vm, be sure that the disk drive is not writable (this is a last resort, you should first try to work on a copy or on a write blocked drive).<br />
</p>

<p>
Be wary of proprietary and non free software.<br />
</p>
</div>
</div>

<div id="outline-container-org37771ef" class="outline-4">
<h4 id="org37771ef">Repeatibility</h4>
<div class="outline-text-4" id="text-org37771ef">
<p>
Since any other expert must be able to perform the same experiment, you should <b>avoid proprietary/paid forensic solutions</b>.<br />
</p>

<p>
Moreover, if a machine is subject to a job without fully understanding (or having access to) how the job innerly works, you cannot say that its output represents truly repeatable evidence, since the expert should be (in theory) able to <b>perform the same analysis by hand</b>.<br />
</p>
</div>

<div id="outline-container-org4d2aab8" class="outline-5">
<h5 id="org4d2aab8">Law enforcement tools</h5>
<div class="outline-text-5" id="text-org4d2aab8">
<p>
Adversarial Investigation tools that <b>must be left hidden</b> to the public in order to avoid other people (e.g. criminals) finding ways to circumvent them.<br />
</p>

<p>
They are <i>not really fit</i> for the job, since to make an analysis scientific the tool shall be used and undestood by other experts.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org0366966" class="outline-4">
<h4 id="org0366966">What analysis encompasses</h4>
<div class="outline-text-4" id="text-org0366966">
<p>
We will focus on tasks that happens only in forensics, but be careful: forensic analysis encompasses everything you have studied.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org8a99faa" class="outline-3">
<h3 id="org8a99faa">Data Recovery</h3>
<div class="outline-text-3" id="text-org8a99faa">
<p>
One of the most typical tasks of computer forensics<br />
</p>
</div>

<div id="outline-container-org876292d" class="outline-4">
<h4 id="org876292d">Disk Geometry</h4>
<div class="outline-text-4" id="text-org876292d">
<p>
The data is read from the tracks on the platters.<br />
The minimum part of the track that can be read is a <b>Sector</b>.<br />
The minimum block that can be allocated for a file is a <b>Cluster</b>.<br />
A cilinder is the set of tracks that are on the same position (on different platters) on the drive.<br />
</p>

<p>
When a file is not exactly a multiple of clusters, the operating systems allocates the clusters anyway.<br />
</p>

<p>
The area that is left between the file end and the end of the last cluster is called &ldquo;slack space&rdquo;.<br />
This chunk of data contains the <b>remains of previously deleted stuff</b>.<br />
</p>

<p>
If this data is text or otherwise an easily recognizable file format, you can reconstruct (at least a minimal part of) a file.<br />
Zip files, most of images and audio etc. are probably not reconstructable this way, since they rely on headers and other file sections.<br />
</p>

<p>
But we could check if a file we are seeking for matches with the part in the slack space, to have a partial confirmation.<br />
</p>
</div>
</div>

<div id="outline-container-org0f7d950" class="outline-4">
<h4 id="org0f7d950">File system</h4>
<div class="outline-text-4" id="text-org0f7d950">
<p>
The file system is the equivalent of the index of a series of folders and files.<br />
In each <b>inode</b> you have a table of (direct | indirect) pointers to data blocks in the hard drive.<br />
</p>

<p>
On file deletion, the file system entry is marked as free.<br />
After some time, the file system entry (not the data itself) is freed and, after some more time, the data block might be overwritten.<br />
</p>

<p>
If we want to access the deleted files, we either:<br />
</p>
<ul class="org-ul">
<li><b>if the file entry was not deleted</b>: un-mark the file entry in the inode for deletion<br /></li>
<li><b>if the file entry deletion has already taken place</b>: ignore the inode and look for the block.<br /></li>
</ul>
</div>
</div>

<div id="outline-container-orgfdf5900" class="outline-4">
<h4 id="orgfdf5900">Carving</h4>
<div class="outline-text-4" id="text-orgfdf5900">
<p>
Another method to retrieve data is the carving method, which consists in:<br />
</p>
<ol class="org-ol">
<li>Scan the drive as a single bit stream<br /></li>
<li><b>locate MIME types</b> of interesting file types<br /></li>
<li>consider anything in between as a candidate file.<br /></li>
</ol>

<p>
As the steps above show, carving <b>doesn&rsquo;t use informations from the file system</b>.<br />
</p>

<p>
The problem comes when encryption and/or compression are taken into consideration, where file types cannot be recognized anymore.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org1f3e89c" class="outline-3">
<h3 id="org1f3e89c">Antiforensic Techniques</h3>
<div class="outline-text-3" id="text-org1f3e89c">
<p>
Aimed at circumventing the forensic analyst.<br />
They are called transient when they just deviate the analysis, definitive when they destroy/tamper the evidence.<br />
</p>

<p>
The <b>most vunerable phases</b> are aquisition and identification.<br />
</p>

<p>
<b>Transient antiforensics</b> interfere mostly with identification, but can be detected.<br />
<b>Definitive antiforensics</b> interfere with identification, since .<br />
</p>
</div>
<div id="outline-container-orgbba61f7" class="outline-4">
<h4 id="orgbba61f7">Timeline tampering</h4>
<div class="outline-text-4" id="text-orgbba61f7">
<p>
A technique that consists in modifying the timestamp of files on the disk to make them appear not correlated one another.<br />
It&rsquo;s a <b>definitive antiforensics</b> technique, since the old timestamp is not available anymore.<br />
</p>
</div>
</div>
<div id="outline-container-orge690b4c" class="outline-4">
<h4 id="orge690b4c">Countering file recovery</h4>
<div class="outline-text-4" id="text-orge690b4c">
<p>
File recovery uses data remnants on the disk, so:<br />
</p>
<ul class="org-ul">
<li>secure deletion of files<br /></li>
<li>encryption<br /></li>
<li>virtual machines<br /></li>
</ul>
<p>
Are all available methods to avoid data to be recovered.<br />
It is a definitive antiforensics method since it destroys (or negates the creation of) the evidence.<br />
</p>

<p>
The &ldquo;residual of magnetization&rdquo; is a file recovery method studied during the 90es.<br />
A 0 written where there was a 0 has a magnetization level slightly different than a 0 written where there was written a 1.<br />
This was never shown to be practical, but it was a reasonable assumption with the technology from the 90es; Nowadays (due to the high density of the bits) it is unusable.<br />
</p>
</div>
</div>
<div id="outline-container-org55ad53a" class="outline-4">
<h4 id="org55ad53a">Fileless attacks</h4>
<div class="outline-text-4" id="text-org55ad53a">
<p>
No traces are left on the disk at all.<br />
Metasploit has this feature: it injects in memory a DLL.<br />
Thus all traces are lost after the machine is turned off (and turning off is one of the main steps to analyze data.)<br />
</p>
</div>
</div>
<div id="outline-container-org969ef0c" class="outline-4">
<h4 id="org969ef0c">Filesystem insertion and subversion technologies</h4>
<div class="outline-text-4" id="text-org969ef0c">
<p>
We place the data where there&rsquo;s no reason to look for them (in the metadata section of the file system).<br />
The partition table, for example, has 32KB assigned, but in effective use, usually, it has 1KB at most.<br />
</p>

<ul class="org-ul">
<li>Inodes for bad blocks are created by the system to not use them.<br />
If we manage to pass a good block as a bad one, we get some free real estate.<br /></li>
<li>You can use directory inodes to, instead, point to data blocks<br /></li>
<li>We can put data in metadata structures ignored by forensic tools (this method is weak to carving)<br /></li>
</ul>

<p>
It is a transient antiforensic method, since the evidence is hidden and not destroyed.<br />
</p>
</div>
</div>
<div id="outline-container-orgc9e0ff2" class="outline-4">
<h4 id="orgc9e0ff2">Log analisys and tampering</h4>
<div class="outline-text-4" id="text-orgc9e0ff2">
<p>
If an attacker has access to the log files, it can tamper them to insert fake log entries or malicious code (this last option is only useful if they are automatically analyzed).<br />
</p>

<p>
It is a <b>transient antiforensics</b> technique.<br />
</p>
</div>
</div>

<div id="outline-container-org4dc34f4" class="outline-4">
<h4 id="org4dc34f4">Patition table analisys</h4>
<div class="outline-text-4" id="text-org4dc34f4">
<ul class="org-ul">
<li>If a partition is not correctly aligned, the OS (Windows) might still use it, while forensic tools might miss them.<br /></li>
<li>Normally, there is only one extendend partition per disk. Windows and Linux can manage multiple extended partitions, but forensic analysis tools might not support them.<br /></li>
<li>A high number of logical partitions in an extended one might bring the tool to crash.<br />
The case was with NCase, 15 years ago. It supported at most 26 partitions (one for each letter of the alphabet).<br /></li>
</ul>

<p>
This too is a <b>transient antiforensics</b> technique, since the data that composes the evidence is not altered.<br />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org2dbfc42" class="outline-2">
<h2 id="org2dbfc42">SSD-forensics</h2>
<div class="outline-text-2" id="text-org2dbfc42">
<p>
SSDs are based on NAND based flash memory, widely used in mobile devices.<br />
</p>
</div>
<div id="outline-container-org663cb6d" class="outline-3">
<h3 id="org663cb6d">FTL</h3>
<div class="outline-text-3" id="text-org663cb6d">
<p>
In order to write on nand, you need to blank the block completely.<br />
FTL (flash translation layer) chips are devices used to optimize the access to the SSD<br />
Functionalities:<br />
</p>
<ul class="org-ul">
<li>Caching<br />
Avoid blanking a block with one single bit flipped<br /></li>
<li>Trimming<br />
When the drive is idle, start trimming (clearing) blocks. It depends on the operating system to tell which blocks to trim.<br /></li>
<li>Garbage Collection<br />
An advanced form of trimming not dependent on the OS<br /></li>
<li>Data compression<br />
Avoid writing multiple blocks when possible<br /></li>
<li>Bad block handling<br />
When a cell is about to fail, the ssd should stop using it<br /></li>
<li>Wear leveling<br />
When we have a cell that has been written many times, we try to move on it static data.<br /></li>
</ul>

<p>
Since the FTL decides how to compress and obfuscate data and shuffles it (for wear leveling, even when the OS isn&rsquo;t running), it is the only one with the knowledge of the mapping between the logical structure of the data seen by the OS and the physical layout.<br />
</p>

<p>
The FTL cannot be disabled via software. You can read the chips with external tools (extremely difficult), risking the destruction of the drive.<br />
</p>

<p>
The FTL, moreover, is not standard: It is the main difference between different vendors (chips are usually the same) and, as such, they are intellectual property that they try to protect.<br />
</p>
</div>
</div>

<div id="outline-container-org15623f1" class="outline-3">
<h3 id="org15623f1">Tests</h3>
<div class="outline-text-3" id="text-org15623f1">
<p>
A set of tests was developed to assess the impacts of FTL on the use of black-box tools.<br />
</p>
</div>
<div id="outline-container-orgce484fb" class="outline-4">
<h4 id="orgce484fb">Trimming</h4>
<div class="outline-text-4" id="text-orgce484fb">
<p>
Trim activates after a second of the drive being IDLE, and it is very aggressive.<br />
After ten second from the erase of the drive, it will be completely empties (looking through the FTL).<br />
</p>
</div>
</div>

<div id="outline-container-org9989500" class="outline-4">
<h4 id="org9989500">Garbage Collection</h4>
<div class="outline-text-4" id="text-org9989500">
<p>
We didn&rsquo;t find Garbage collection of the drives.<br />
</p>
</div>
</div>

<div id="outline-container-orgd5cca5d" class="outline-4">
<h4 id="orgd5cca5d">Erasing patterns</h4>
<div class="outline-text-4" id="text-orgd5cca5d">
<p>
Certain SSD controllers exhibit unexpected trimming patterns.<br />
</p>
</div>
</div>

<div id="outline-container-org9616c24" class="outline-4">
<h4 id="org9616c24">Compression</h4>
<div class="outline-text-4" id="text-org9616c24">
<p>
Files with High entropy (that cannot be compressed) will take more time to be written<br />
</p>
</div>
</div>

<div id="outline-container-orgde6e2fe" class="outline-4">
<h4 id="orgde6e2fe">Wear Leveling</h4>
<div class="outline-text-4" id="text-orgde6e2fe">
<p>
We thought that wear leveling, since it would make shadow copies of the files, could help the forensic analysis. It does not.<br />
</p>
</div>
</div>

<div id="outline-container-orgd0311d4" class="outline-4">
<h4 id="orgd0311d4">Reults on file recoverability</h4>
<div class="outline-text-4" id="text-orgd0311d4">
<p>
Very detrimental. If TRIM is active, it&rsquo;s quite difficult to recover any file.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgd652301" class="outline-3">
<h3 id="orgd652301">Conclusions</h3>
<div class="outline-text-3" id="text-orgd652301">
<p>
For forensics analysts, SSD are a pain in the arse.<br />
We can say that SSDs have an &ldquo;intrinsic&rdquo; secure deletion system.<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgcdedf95" class="outline-2">
<h2 id="orgcdedf95">Evaluation and presentation</h2>
<div class="outline-text-2" id="text-orgcdedf95">
<p>
These phases are tightly coupled with experience and are difficult to teach generally.<br />
</p>
</div>
<div id="outline-container-orgc05a852" class="outline-3">
<h3 id="orgc05a852">Evaluation phase</h3>
<div class="outline-text-3" id="text-orgc05a852">
<p>
Consists in <b>matching the evidence elements with the required legal elements to support/negate a legal theory</b>.<br />
</p>

<p>
The experts and the lawyer sit down and share their expertise, trying to match the requirements to negate or confirm an allegation.<br />
</p>

<p>
The judge will analyze what can be said now, what cannot be said and what are the other possible experiments to find something new.<br />
But sometimes, showing a feasible experiment to the jury can be detrimental to our own cause; There is a <b>risk</b> associated with each experiment we make.<br />
</p>

<p>
Very often, expert witnesses work on the results of other experts (not on the evidence itself).<br />
All experts must testify with objective facts (without interpretation or twisting) but they are not required to be completely non-sided to the matter (so they might want to avoid certain tests etc.)<br />
But be wary, since omission of truth is persecutable in Italy <b>experts cannot</b>, when asked, <b>claim professional secrecy</b>.<br />
</p>

<p>
After each analysis, the expert is asked a series of question called &ldquo;quesito peritale&rdquo;. One of the question is &ldquo;riferisca quant&rsquo;altro pu essere utile ai fini di giustizia&rdquo;.<br />
This implies that, should you find another crime evidence during your analysis, you are forced to say so.<br />
</p>
</div>

<div id="outline-container-org7a51d89" class="outline-4">
<h4 id="org7a51d89">Analyzing the documents</h4>
<div class="outline-text-4" id="text-org7a51d89">
<p>
You always need to analyze what can be said and <i>what can not</i>, possibly specifying <b>what further experiments would be needed</b> to say more.<br />
</p>

<p>
This last analysis must be perfomed to be prepared on what experiments the counterpart will perform and what will be the repercussions if out part asks to make such experiments.<br />
</p>

<p>
It&rsquo;s also very important to <b>review previous dovuments and evidences</b>, to look for technical/factual errors, suggestive writing, opinions not distinct from facts.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgb8fdc23" class="outline-3">
<h3 id="orgb8fdc23">The relationship with lawyers, customers and prosecutor/police</h3>
<div class="outline-text-3" id="text-orgb8fdc23">
<p>
The important thing to remember is that: &ldquo;unless you are a police officer, you are not a policeman&rdquo;. It&rsquo;s <b>not your duty to punish</b> someone.<br />
Unless you are a lawyer, it&rsquo;s <b>not your duty to protect</b> people either (even though lawyers and customers pay your bills).<br />
You may be asked by the lawyer to omit a finding though (as long as it&rsquo;s not the same as lying).<br />
</p>

<p>
You should never compromise the trust of the customer in their lawyer.<br />
</p>

<p>
The process truth is not the same as historical truth: The law may not support incriminating someone that may be guilty historically.<br />
</p>

<p>
It is super important to stick to facts and science, we&rsquo;re <b>not fighting for justice</b>, and your thoughts must not be shaped by it.<br />
</p>

<p>
In Italy, a super-partes kind of experts are available: the judge experts, requested by the judge to review the evidence.<br />
</p>
</div>
</div>
<div id="outline-container-orgc0bd651" class="outline-3">
<h3 id="orgc0bd651">Typical errors found in reports and analyses and presentation errors</h3>
<div class="outline-text-3" id="text-orgc0bd651">
<p>
If the theory is that &ldquo;a supernatural/incredibly powerful being did something&rdquo; and that cannot be confuted, it is a &ldquo;trojan defense&rdquo;.<br />
(You can never exclude a trojan virus that deletes itself put the files on my computer, but it is not <b>falsifiable</b> so not <b>scientific</b>)<br />
We can provide additional explanations and alternative theories to these.<br />
</p>

<p>
Many court cases drag over a long time, so having a good written report (presentation) can be lifesaving to gather back the informations.<br />
The report you signed is the only thing you can bring with you in a court.<br />
</p>
</div>

<div id="outline-container-org00381d3" class="outline-4">
<h4 id="org00381d3">What to look for</h4>
<div class="outline-text-4" id="text-org00381d3">
<ul class="org-ul">
<li><b>Acquisition errors</b><br />
<ul class="org-ul">
<li>missing links in the chain of custody<br /></li>
<li>missing/mismatched serial numbers<br /></li>
<li>errors during hashing/cloning procedures (missing write lockers)<br /></li>
</ul></li>
<li><b>Analysis errors</b><br />
<ul class="org-ul">
<li>steps where the hash is not verified<br /></li>
<li>use of proprietary programs<br /></li>
<li>technical mistakes.<br /></li>
</ul></li>
<li><b>Presentation errors</b><br />
<ul class="org-ul">
<li>the presentation is biased<br /></li>
<li>counter examples for an assumption can be found<br /></li>
<li>alternative theories not explored<br /></li>
</ul></li>
</ul>

<p>
In Italy it is <span class="underline">not enough to demonstrate that an analysis was not conducted in a correct way</span>, but if you can raise questions and <span class="underline">show that other results are feasible</span> with the same set of informations and another analysis method, you can bring the jury to your side.<br />
That&rsquo;s why, during the presentation phase, you must be meticolous and list all possible counter examples.<br />
</p>

<p>
On the other side, if you cannot dispute the facts that the opposition is saying about your client, you can dispute their presentation.<br />
</p>
</div>
</div>

<div id="outline-container-org5099aa3" class="outline-4">
<h4 id="org5099aa3">What to do when your client is in the wrong</h4>
<div class="outline-text-4" id="text-org5099aa3">
<p>
You can avoid to present the informations about your client that aren&rsquo;t on your favor.<br />
But if the prosecutor asks, you must respond (unless you &ldquo;didn&rsquo;t touch&rdquo; the topic in your analysis)<br />
&ldquo;It&rsquo;s the ill people that need doctors&rdquo;<br />
</p>
</div>
</div>

<div id="outline-container-org4024a6f" class="outline-4">
<h4 id="org4024a6f">Writing your report</h4>
<div class="outline-text-4" id="text-org4024a6f">
<p>
You want to explain the situation in a simple way, but not a simplistic way.<br />
The judge won&rsquo;t like to be treated like a child, but he will want to understand everything (so all the technical terminology will have to be explained).<br />
You will also have to explain why certain things are relevant.<br />
</p>
</div>
</div>

<div id="outline-container-org09cbe80" class="outline-4">
<h4 id="org09cbe80">Structure of a report</h4>
<div class="outline-text-4" id="text-org09cbe80">
<p>
Always explain the reasons behind an analysis and its results.<br />
</p>

<p>
Try to write &ldquo;obstacles&rdquo; in the way to get your client sentenced:<br />
</p>
<ul class="org-ul">
<li>&ldquo;the opposition did this&rdquo;<br /></li>
<li>&ldquo;By doing this, they actually ruled out this&rdquo;<br /></li>
<li>&ldquo;Even ignoring this, the evidence could be explained better with this&rdquo;<br /></li>
</ul>

<p>
Always write in the introduction what is your very conclusion.<br />
</p>

<p>
The conclusion is, most of the times, the only things the judge considers.<br />
Give a fast write up of what was written in the report, then use a strong ending phrase.<br />
<b>Stay factual</b>.<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgc8c512d" class="outline-3">
<h3 id="orgc8c512d">Testimony as a witness</h3>
<div class="outline-text-3" id="text-orgc8c512d">
<p>
In many jurisdiction, the expert may be called as a witness or may only just have to submit a report.<br />
In Italy, if you are working in a criminal procedure, you must be called as a witness.<br />
</p>

<p>
In Italy, you are asked to know you duty as a witness: answer truthfully and not hide anything you know.<br />
</p>
</div>
</div>

<div id="outline-container-org537b31d" class="outline-3">
<h3 id="org537b31d">Direct and cross examination</h3>
<div class="outline-text-3" id="text-org537b31d">
<ul class="org-ul">
<li><b>Direct examination</b><br />
you are <i>first</i> called by your side and proceed to a friendly direct examination.<br />
In this examination you must:<br />
<ul class="org-ul">
<li>be as helpful as possible<br /></li>
<li>be as clear as possible (make sure you explain everything to the judge)<br /></li>
<li>check previous records of the jusdge to prepare for possible questions<br /></li>
</ul></li>

<li><b>Cross examination</b><br />
you are called by the opposing side to testify. This is usually much more difficult than its direct counterpart.<br />
In this examination you want to:<br />
<ul class="org-ul">
<li>be court if you can, and if you can not be very complex and difficult to understand (you can take you time talking by looking at your report)<br /></li>
<li>If a question is positive for your side, be extremely clear and helpful<br /></li>
<li>Don&rsquo;t get personal on the things they say and don&rsquo;t get angry<br /></li>
</ul></li>
</ul>

<p>
In civil court, witnesses are expected to provide answers to questions that were listed to the judge, in the form of &ldquo;is it true that..&rdquo;.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgf0f63a7" class="outline-2">
<h2 id="orgf0f63a7">Fraud analysis and detection (carminati, 16/04/21)</h2>
<div class="outline-text-2" id="text-orgf0f63a7">
<p>
What is a <b>fraud</b>? It&rsquo;s a wrongful or criminal deception intended for financial or personal gain.<br />
In particular, it is:<br />
</p>

<ul class="org-ul">
<li><b>uncommon</b><br />
Only a minority of cases concerns fraud, which makes it difficult to detect frauds and to learn from historical cases (due to them being quite few).<br /></li>
<li><b>well considered and imperceptibly concealed</b><br />
Fraudsters remain unnoticed and covered by planning ahead their actions.<br /></li>
<li><b>time evolving</b><br />
fraud techniques evolve in time, ahead of fraud detection systems.<br /></li>
<li><b>carefully organized</b><br />
Fraudsters do not operate independently, they involve complex and organized structures.<br /></li>
</ul>
</div>

<div id="outline-container-org2fe1c96" class="outline-3">
<h3 id="org2fe1c96">Why people commit fraud</h3>
<div class="outline-text-3" id="text-org2fe1c96">
<p>
The main reason is the <span class="underline">potential monetary gain</span>.<br />
But we have an abstact model that tries to explain the drivers of a fraud, the <b>fraud triangle</b>, composed of:<br />
</p>
<ul class="org-ul">
<li>motivation<br /></li>
<li>opportunity<br /></li>
<li>rationalization<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org9c53254" class="outline-3">
<h3 id="org9c53254">Fraud categories</h3>
<div class="outline-text-3" id="text-org9c53254">
<ul class="org-ul">
<li>Banking and credit card frauds<br />
Has two subtypes:<br />
<ul class="org-ul">
<li>application fraud: obtain new credit cards from issuing companies by using false data and spend as much money as possible in a short time.<br /></li>
<li>behvioral fraud: detail of legit cards are obtained fraudolently. Does not necessarily require stealing the physical card, but the credentials.<br /></li>
</ul></li>
<li>Insurance fraud<br />
Can be either:<br />
<ul class="org-ul">
<li>from the side of the seller, if we<br />
<ul class="org-ul">
<li>sell policies for nonexistent companies<br /></li>
<li>setting up multiple policies to create commissions<br /></li>
</ul></li>
<li>from the side of the buyer, if we<br />
<ul class="org-ul">
<li>exaggerate claims<br /></li>
<li>falsify medical history<br /></li>
<li>fake death/kidnapping etc<br /></li>
<li>fake damage to our vehichle<br /></li>
</ul></li>
</ul></li>
<li>Corruption<br />
Misuse of entrusted power for personal gain.<br /></li>
<li>Counterfition<br />
A counterfeit is an imitation intended to be passes off fraudulently or deceptively.<br />
It is usually done on valuable objects like money, credit cards, popular products etc.<br /></li>
<li>Product warranty fraud<br />
Fraudently claiming compensation or remuneration based on a product warranty.<br /></li>
<li>Healthcare fraud<br />
Filling dishonest healthcare claims to make profit.<br /></li>
<li>Telecommunication fraud<br />
Theft/use of communication services to commit other frauds.<br />
<ul class="org-ul">
<li>cloning fraud: clone a number and the related call credit.<br /></li>
<li>superimposition fraud: fraudolent usage is added to the legit use of an account.<br /></li>
</ul></li>
<li>Money laundering<br />
Transform illegal money into legit funds.<br /></li>
<li>Click frauds<br />
Illegal clicks on a website advertisement to increase the payable number of clicks to the advertiser.<br />
Identity theft<br />
Obtain the financial/personal informations of another person for the purpose of assuming that person&rsquo;s identity to make purchases.<br /></li>
<li>Tax evasion<br />
Illegal act or practice of not paying (or paying partially) taxes that are owed.<br /></li>
<li>Plagiarism<br />
Use another&rsquo;s production without crediting the source<br />
It involves both stealing someone&rsquo;s work and lying about it afterwards.<br /></li>
<li>Sim swap attacks<br />
The attacker contacts your phone operator, asks for a new sim, get control of it, get access to your authentication method (if your phone is the secure point).<br />
The second factor authentication based on the sim introduced by banks caused this kind of frauds.<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org1e340c1" class="outline-3">
<h3 id="org1e340c1">Anti-fraud stategies</h3>
<div class="outline-text-3" id="text-org1e340c1">
</div>
<div id="outline-container-org0e549b4" class="outline-4">
<h4 id="org0e549b4">Anti fraud mechanisms</h4>
<div class="outline-text-4" id="text-org0e549b4">
<p>
Reduce losses due to frauds:<br />
</p>
<ul class="org-ul">
<li>Prevents and detect part of the frauds.<br /></li>
<li>hinder fraudsters who will look for other easier opportunities. (go on other organizations)<br /></li>
</ul>
</div>
</div>
<div id="outline-container-orga13c288" class="outline-4">
<h4 id="orga13c288">Fraud detection and Fraud prevention</h4>
<div class="outline-text-4" id="text-orga13c288">
<p>
<span class="underline">Fraud detection</span> mechanisms recognize fraudolent activities after they have happened (ex-post approach)<br />
They usually provide the analyst with an index risk of fraud, depending on the past transaction (behavior) of the user<br />
</p>

<p>
<span class="underline">Fraud prevention</span> mechanisms avoid or reduce the frauds that will happen (ex-ante approach)<br />
</p>

<p>
They are <b>complementary</b> and <b>not independent</b>: if a fraud adapts to a detection mechanism, it will also impact prevention mechanisms and vice-versa.<br />
</p>
</div>

<div id="outline-container-org9d1ff89" class="outline-5">
<h5 id="org9d1ff89">Example of fraud prevention: Strong customer authentication</h5>
<div class="outline-text-5" id="text-org9d1ff89">
<p>
New European requirement to make the payment. Two authentication methods are required to make a payment.<br />
They are required to make online card payments in the European Economic Area.<br />
</p>

<p>
Exemption: payments below 30 euros/low risk transaction (due to user friendliness)<br />
</p>

<p>
Each single security measure impacts the cost and usability of a system.<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org425cd4c" class="outline-4">
<h4 id="org425cd4c">Strategies for Fraud detection and prevention</h4>
<div class="outline-text-4" id="text-org425cd4c">
</div>
<div id="outline-container-orga07b884" class="outline-5">
<h5 id="orga07b884">Expert-based approach</h5>
<div class="outline-text-5" id="text-orga07b884">
<p>
This approach to fraud analysis is built on the domain knowledge of the fraud analyst.<br />
It involves <b>manual investigation</b> of a suspicious case to understand the fraud mechanism.<br />
</p>

<p>
It may find <b>new fraud mechanisms</b>.<br />
</p>

<p>
They are usually implemented with if-then-else rules engine.<br />
If the amount of claim is above the threshold, if there is a severe accident but no police/doctor report etc, then flag it as suspicious.<br />
</p>
</div>

<div id="outline-container-orgb4d7c59" class="outline-6">
<h6 id="orgb4d7c59">Rule based engines</h6>
<div class="outline-text-6" id="text-orgb4d7c59">
<p>
Rule-based engine are expensive to build and they <b>must be kept secret</b> from fraudsters, which can learn the rules and circumvent them.<br />
Moreover, new <i>fraud patterns are not automatically signaled</i>: you must first make new rules for them.<br />
</p>

<p>
There are some disadvantages though:<br />
</p>
<ul class="org-ul">
<li>expensive to build: require manual input and they&rsquo;re difficult to mantain and manage<br /></li>
<li>must be continuously monitored, improved and updated.<br /></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org20cab3a" class="outline-5">
<h5 id="org20cab3a">Automated fraud detection system</h5>
<div class="outline-text-5" id="text-org20cab3a">
<p>
An automated system for detecting fraud requires less human involvement and could lead to a more efficient system, <b>based on data analysis</b>.<br />
<span class="underline">Expert knowledge remains, in any case, crucial to build the system</span>.<br />
</p>
</div>
</div>

<div id="outline-container-org6a65376" class="outline-5">
<h5 id="org6a65376">Data driven fraud detection</h5>
<div class="outline-text-5" id="text-org6a65376">
<p>
Based on machine learning.<br />
It is <b>precise</b>, due to the increased detection power than classic approaches and the massive amount of informations available from previous frauds used to uncover frauds that are not apparent.<br />
It is <b>efficient</b>, because it cost much less to automate the analysis than expert-based fraud detection systems.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org46ba359" class="outline-4">
<h4 id="org46ba359">Fraud management</h4>
<div class="outline-text-4" id="text-org46ba359">
<p>
When a fraud is detected, it must be<br />
</p>
<ul class="org-ul">
<li><b>corrected</b>, by providing a compensation for example. Note that you can be required to look at the past to be sure it didn&rsquo;t happen before.<br /></li>
<li><b>prevented</b> from happening again.<br /></li>
</ul>

<p>
A fraud becomes easier to detect the more time has passed, due to copycats using the same fraud over and over.<br />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgdaa1b24" class="outline-2">
<h2 id="orgdaa1b24">Fraud Detection (carminati, 21/04/21)</h2>
<div class="outline-text-2" id="text-orgdaa1b24">
</div>
<div id="outline-container-org3c5c671" class="outline-3">
<h3 id="org3c5c671">Frauds as a dynamic phenomenon</h3>
<div class="outline-text-3" id="text-org3c5c671">
<p>
Frauds remain hard and complex to detect.<br />
</p>

<p>
A fraudster may think about sending fraudolent transactions that may try to <b>shift the model of fraud detection systems</b> of an institution.<br />
Unsupervised learning technique must be still monitored by experts.<br />
</p>
</div>
</div>
<div id="outline-container-org33763c8" class="outline-3">
<h3 id="org33763c8">Techniques to detect a fraud automatically</h3>
<div class="outline-text-3" id="text-org33763c8">
<p>
New techniques able to <span class="underline">adapt to new frauds</span> are needed.<br />
They can either be<br />
</p>
<ul class="org-ul">
<li><b>Unsupervised learning</b> (or descriptive) analytics techniques<br /></li>
<li><b>Supervised learning</b> (or predictive) analytics techniques<br /></li>
</ul>
</div>

<div id="outline-container-org1e178dc" class="outline-4">
<h4 id="org1e178dc">Unsupervised learning analytics techniques</h4>
<div class="outline-text-4" id="text-org1e178dc">
<p>
They do not require labeled observations. They learn from past observations by <b>detecting anomalies</b>.<br />
They can detect novel fraud patterns.<br />
</p>
</div>

<div id="outline-container-org4cbd815" class="outline-5">
<h5 id="org4cbd815">Telecommunication example</h5>
<div class="outline-text-5" id="text-org4cbd815">
<p>
I can see a fraud is in act if I see <i>multiple short calls</i>, <i>during night hours</i> and <i>with little time between one another</i>.<br />
But note that there can be multiple false negatives.<br />
</p>
</div>
</div>

<div id="outline-container-org4a04c57" class="outline-5">
<h5 id="org4a04c57">Limitations</h5>
<div class="outline-text-5" id="text-org4a04c57">
<p>
Unsupervised learning techniques are <b>prone to deception</b> by camouflage-like fraud strategies.<br />
They need to be complemented by other tools.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org9720032" class="outline-4">
<h4 id="org9720032">Supervised learning techniques</h4>
<div class="outline-text-4" id="text-org9720032">
<p>
learn from <b>labeled</b> historical observations, where the fraud was exposed.<br />
They can find known alarms that fraudsters cannot hide.<br />
</p>
</div>

<div id="outline-container-org8b3ce94" class="outline-5">
<h5 id="org8b3ce94">Limitations</h5>
<div class="outline-text-5" id="text-org8b3ce94">
<ul class="org-ul">
<li>Low detection power against new fraud types<br /></li>
<li>Need a labeled set to learn from<br /></li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-org3610a85" class="outline-3">
<h3 id="org3610a85">Developing a fraud detection system</h3>
<div class="outline-text-3" id="text-org3610a85">
<ol class="org-ol">
<li>Start with an Expert-based rule engine<br /></li>
<li>use a unsupervised learning system<br /></li>
<li>use a supervised learning system once you have build your labeled history<br /></li>
</ol>
<p>
The exact order of adoption depends from case to case.<br />
</p>
</div>
</div>

<div id="outline-container-org1507773" class="outline-3">
<h3 id="org1507773">Social Network Analysis</h3>
<div class="outline-text-3" id="text-org1507773">
<p>
Extends the abilities of fraud detection systems by detecting <span class="underline">characteristics of frauds between linked entities</span>.<br />
</p>
</div>
</div>

<div id="outline-container-org5318ee2" class="outline-3">
<h3 id="org5318ee2">Fraud management cycle</h3>
<div class="outline-text-3" id="text-org5318ee2">
<p>
you have to put together the following steps:<br />
</p>
<ol class="org-ol">
<li>fraud <b>detection</b> : applying detection models on new observations<br /></li>
<li>fraud <b>investigation</b> : human expert investigates on a flagged fraud<br /></li>
<li>fraud <b>confirmation</b> : determining the kind (label) of fraud<br /></li>
<li>fraud <b>prevention</b> : preventing frauds to be committed in the future by marking them as frauds faster and faster.<br /></li>
<li>Finally, you need to put an <b>automated detection algorithm</b> to create and update the detection model with the confirmed frauds.<br /></li>
</ol>
</div>

<div id="outline-container-org666446a" class="outline-4">
<h4 id="org666446a">Regular update of the model</h4>
<div class="outline-text-4" id="text-org666446a">
<p>
The <b>frequency</b> of update of your model depends on:<br />
</p>
<ul class="org-ul">
<li>the <span class="underline">volatility</span> of the fraud behavior<br /></li>
<li>the <span class="underline">detection power</span> of the model<br /></li>
<li>amount of <span class="underline">similar confirmed case available</span><br /></li>
<li>the <span class="underline">rate of new cases</span> being confirmed<br /></li>
<li>the <span class="underline">required effort</span> to retain the model<br /></li>
</ul>
</div>

<div id="outline-container-org1746190" class="outline-5">
<h5 id="org1746190">Reinforcement learning</h5>
<div class="outline-text-5" id="text-org1746190">
<p>
Instead of waiting for a window to update the model, continuously update it as soon as new data is available.<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org93f353f" class="outline-4">
<h4 id="org93f353f">Example: Credit card fraud</h4>
<div class="outline-text-4" id="text-org93f353f">
<p>
<b>Outlier detection</b> is made by analyzing clusters of common transaction based on position and time.<br />
If a transaction happens outside of a group (it&rsquo;s an outlier), they might be a fraud.<br />
</p>

<p>
Users are analyzed in the same way at a system level, based on their age and income.<br />
An outlier might be a fraudster or a victim.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgef7482f" class="outline-3">
<h3 id="orgef7482f">Fraud analytical process</h3>
<div class="outline-text-3" id="text-orgef7482f">
<p>
How to develop a <b>fraud analysis model</b>.<br />
</p>

<p>
The process is split in three main parts:<br />
</p>
<ul class="org-ul">
<li>preprocessing (the most important and time consuming)<br />
The performance of your model will strictly depend on this step.<br /></li>
<li>analytics<br /></li>
<li>post processing<br /></li>
</ul>
</div>

<div id="outline-container-org72bf761" class="outline-4">
<h4 id="org72bf761">Preprocessing</h4>
<div class="outline-text-4" id="text-org72bf761">
<ul class="org-ul">
<li>identify the business problem<br /></li>
<li>identify the data sources<br /></li>
<li>select the data<br /></li>
<li>clean the data (gets rid of inconsistencies)<br /></li>
<li>transform the data (extract additional informations from the data)<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org178a87b" class="outline-4">
<h4 id="org178a87b">Analytics</h4>
<div class="outline-text-4" id="text-org178a87b">
<ul class="org-ul">
<li>Analyze the data. Here the <b>model is built</b> based on the data preprocessed.<br /></li>
</ul>
</div>

<div id="outline-container-orgc5c2f8f" class="outline-5">
<h5 id="orgc5c2f8f">Possible analysis outputs</h5>
<div class="outline-text-5" id="text-orgc5c2f8f">
<ul class="org-ul">
<li>Find known easy frauds, that ensure the system is working<br /></li>
<li>Find unknown patterns, that provide added insight and detection power.<br /></li>
</ul>

<p>
In any case, you&rsquo;re going to work on <b>clusters</b>, and will be trying to extract knowledge from them.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org54fe09f" class="outline-4">
<h4 id="org54fe09f">Post processing phase</h4>
<div class="outline-text-4" id="text-org54fe09f">
<p>
Validate the model created with experts.<br />
</p>
</div>
</div>

<div id="outline-container-orgee88c2c" class="outline-4">
<h4 id="orgee88c2c">Key characteristics of successful fraud analtics models</h4>
<div class="outline-text-4" id="text-orgee88c2c">
<p>
To understand if your system is working I must monitor:<br />
</p>
<ul class="org-ul">
<li>statistical accuracy and significance<br />
Your system must generalize well and <span class="underline">must not be overfitted to the historical data set</span>.<br /></li>
<li>Interpretability<br />
You can put in place the state of art deep learning approach, but if the result of the analysis cannot be interpreted because the model is too complex (it tells us that a particular case might be a fraud, but it won&rsquo;t say why) it is unuseful.<br />
Such a non interpretable system is called <b>black-box</b>, while a system that can be interpreted is a <b>white-box</b> system.<br /></li>
<li>Operational efficiency<br />
The time and effort that is required to obtain a result and evaluate it is important, expecially on <i>real time system</i>.<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org09c42f1" class="outline-4">
<h4 id="org09c42f1">Fraud management as risk management</h4>
<div class="outline-text-4" id="text-org09c42f1">
<p>
Every time we have to deploy a fraud management system, we must consider<br />
</p>
<ul class="org-ul">
<li>the value of the asset we want to protect<br /></li>
<li>the vulnerabilities<br /></li>
<li>the threats<br /></li>
<li><p>
the cost of the system (both direct and <span class="underline">indirect</span>)<br />
Indirect costs are mainly<br />
</p>
<ul class="org-ul">
<li>less usability for the user<br /></li>
<li>slower performance<br /></li>
<li>less privacy<br /></li>
<li>reduced productivity (users are slower)<br /></li>
</ul>
<p>
Direct costs are the equipment, its management and its operation.<br />
</p></li>
</ul>
</div>

<div id="outline-container-orge0865de" class="outline-5">
<h5 id="orge0865de">Economical cost</h5>
<div class="outline-text-5" id="text-orge0865de">
<p>
Developing and implementing a fraud-detection model involves a significant cost to an organization.<br />
</p>

<p>
A cost-benefit analysis to understand the returns on investment that you gain with a fraud detection system.<br />
</p>

<p>
Moreover, now that the fraud-detection model should go under the <span class="underline">privacy regulations</span>, it&rsquo;s really difficult to put up a dataset big enough.<br />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org6845c2f" class="outline-3">
<h3 id="org6845c2f">Challenges of developing fraud-detection models</h3>
<div class="outline-text-3" id="text-org6845c2f">
<ul class="org-ul">
<li>Dynamic nature of frauds<br />
As previously seen, fraudsters will keep on trying to beat detection and prevention systems by developing new strategies and methods.<br />
We will need <span class="underline">adaptive</span> models for detection and prevention.<br /></li>
<li><b>Accuracy</b><br />
You don&rsquo;t want to miss on too many frauds, but you want to keep a low false alarm rate.<br />
All in all, the cost of missing a fraudolent case will probably be higher than marking a legit one as fraudolent.<br /></li>
<li><b>Skewness<sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup></b> of the data<br />
The number of fraudolent cases is small w.r.t. the number of legit ones.<br />
An analytical technique might have some difficulties in learning an accurate model.<br /></li>
<li><b>Time efficiency</b><br />
The model must be fast enough to reach a decision (fraudolent or not) in the time window before the next batch of transactions arrive.<br /></li>
<li><b>Big data</b> management<br />
The model must be able to deal with massive amounts of data.<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org8ce00fa" class="outline-3">
<h3 id="org8ce00fa">Red flags of frauds</h3>
<div class="outline-text-3" id="text-org8ce00fa">
<p>
What we want to extract from an analysis are the &ldquo; <span class="underline">patterns</span> &rdquo; for frauds, to be used as the grounding truth for new fraud detection systems.<br />
</p>

<p>
This means translating the typical anomalies (called &ldquo;red flags&rdquo; here) of each kind of fraud into expert rules (after being documented) for rule based engines.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org341eabd" class="outline-2">
<h2 id="org341eabd">Machine Learning for Fraud Detection</h2>
<div class="outline-text-2" id="text-org341eabd">
<p>
In the previous section we focused on the fraud analisys and detection management part, where we studied how to counteract frauds.<br />
Let&rsquo;s now focus on how we can apply machine learning techniques in automatic fraud detection. (the more analytical part).<br />
</p>
</div>
<div id="outline-container-org2f7ba4a" class="outline-3">
<h3 id="org2f7ba4a">Notice</h3>
<div class="outline-text-3" id="text-org2f7ba4a">
<p>
During the years, many techniques have been developed for fraud detection with ML from different disciplines.<br />
The main focus won&rsquo;t be on the technicalities of these techniques but on the fraud detection perspective.<br />
</p>
</div>
</div>
<div id="outline-container-orgf1586b0" class="outline-3">
<h3 id="orgf1586b0">Data preprocessing</h3>
<div class="outline-text-3" id="text-orgf1586b0">
<p>
This part is where the experts lose 70% of their time.<br />
</p>
</div>

<div id="outline-container-org992b2c4" class="outline-4">
<h4 id="org992b2c4">Real data problems</h4>
<div class="outline-text-4" id="text-org992b2c4">
<p>
When you&rsquo;re working on the theory, the more data you have the better.<br />
When we move to the real world though, this sentence is not so true anymore.<br />
</p>

<p>
The main motivation relies on the phrase &ldquo;garbage in, garbage out&rdquo;.<br />
It means that, if you have <span class="underline">messy data in your inputs, your analysis will yeld a messy model</span>.<br />
</p>

<p>
We need to <b>filter our data accordingly</b>. Even the slightest mistake can lead to invalid results.<br />
</p>
</div>
</div>

<div id="outline-container-org8ca822a" class="outline-4">
<h4 id="org8ca822a">Types of sources</h4>
<div class="outline-text-4" id="text-org8ca822a">
<p>
To fulfill an analysis, you need to know what data sources to acquire from.<br />
</p>

<p>
Data can be either <b>structured</b> (fits neatly in fixed fields) or <b>unstructured</b> (like data lakes).<br />
</p>

<p>
The main objective is to <b>find correlations between data sources</b>.<br />
</p>
</div>

<div id="outline-container-org77c5eed" class="outline-5">
<h5 id="org77c5eed">Transactional Data</h5>
<div class="outline-text-5" id="text-org77c5eed">
<p>
One kind of data source.<br />
It&rsquo;s composed of structured informations capturing the characteristics of a transaction from a customer.<br />
</p>

<p>
This kind of data is usually summarized to extract the <b>RFM value</b> (recency, frequency and monetary factors):<br />
</p>
<ul class="org-ul">
<li>the Recency factor focuses on the time passed from a transaction to the one before<br /></li>
<li>the Frequency factor focuses on the number of transactions made in the past<br /></li>
<li>the Monetary factorfocuses on the amount of each transaction.<br /></li>
</ul>

<p>
These features can be used individually or jointly, and their interaction can be used to detect frauds.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgdfa025d" class="outline-4">
<h4 id="orgdfa025d">Types of data elements</h4>
<div class="outline-text-4" id="text-orgdfa025d">
<p>
You can either have continuous data or categorical data:<br />
</p>
<ul class="org-ul">
<li><b>Continuous</b> data<br />
data elements are defined on an <span class="underline">interval</span> (limited or unlimited) (the amount of a transaction or its timestamp is an example)<br /></li>
<li><b>Categorical</b> data<br />
<ul class="org-ul">
<li><span class="underline">Nominal</span>: data elements that are <span class="underline">limited on a set of values</span> without ordering (iban; IP; motivation; region)<br /></li>
<li><span class="underline">Ordinal</span>: data elements <span class="underline">limited on a set</span> <span class="underline">with an ordering</span><br /></li>
<li><span class="underline">Binary</span>: data elements that <span class="underline">can only take two values</span>.<br /></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org2f6237a" class="outline-4">
<h4 id="org2f6237a">Sampling</h4>
<div class="outline-text-4" id="text-org2f6237a">
<p>
Sampling consists in taking a subset of the dataset available to build our data model.<br />
This step is needed because we need to <b>generalize</b> and <b>model the future</b>, and to do so we need to <b>focus more on newer data</b> (by taking more samples from newer time frames). A good sample must be <span class="underline">representative for the future</span>.<br />
</p>

<p>
When selecting a sample, you have to select the optimal time window, with a tradeoff between quantity of data and how recent it is.<br />
</p>

<p>
Your <b>average period</b> (the time window you selected) must also be as unbiased as possible, even if it&rsquo;s not straightforward.<br />
</p>
</div>

<div id="outline-container-org13b8dcd" class="outline-5">
<h5 id="org13b8dcd">Bias example</h5>
<div class="outline-text-5" id="text-org13b8dcd">
<p>
In holidays, users change their spending pattern.<br />
Not only that, but also the types of goods bought are different.<br />
</p>

<p>
Each single month might deviate from the average model.<br />
</p>

<p>
To mitigate this issue, we can<br />
</p>
<ul class="org-ul">
<li>build different models <i>for each month</i>.<br />
This is a complex and demanding solution, that does not scale well, but you have an updated and precise model of the customer.<br /></li>
<li>Sample observations over a period covering a full business cycle and build a single model instead.<br /></li>
</ul>

<p>
Sampling has a direct impact on the fraud detection power.<br />
</p>
</div>
</div>

<div id="outline-container-orgc61c59a" class="outline-5">
<h5 id="orgc61c59a">Stratified sampling</h5>
<div class="outline-text-5" id="text-orgc61c59a">
<p>
To make a <i>stratified sample</i> means to <b>keep some properties</b> (found in the data) <b>valid</b> in the sample taken.<br />
</p>

<p>
When doing sampling, you might want to extract samples taking into consideration:<br />
</p>
<ul class="org-ul">
<li>a target for an indicator (<i>bank example</i>: private customer or company have different variability in their destination ibans; we might want to keep this variability intact after our sampling; <i>general example</i>: keep the percentage of fraudolent and non fraudolent transactions the same)<br /></li>
<li>a variable for a predictor<br /></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgc8ae4af" class="outline-4">
<h4 id="orgc8ae4af">Visual data exploration</h4>
<div class="outline-text-4" id="text-orgc8ae4af">
<p>
First informal step after sampling.<br />
You basically analyze the distribution of data visually (through charts) to find its properties.<br />
</p>
</div>
</div>

<div id="outline-container-orge4a5922" class="outline-4">
<h4 id="orge4a5922">Exploratory statistical Analysis</h4>
<div class="outline-text-4" id="text-orge4a5922">
<p>
Some <b>statistical measurements</b> (average, standard deviation etc.) can be made on the data to extract some properties.<br />
</p>

<p>
Some fitting of the distribution of the data can help to understand other characteristics about it.<br />
</p>
</div>
</div>

<div id="outline-container-org44c46fe" class="outline-4">
<h4 id="org44c46fe">Dealing with missing values</h4>
<div class="outline-text-4" id="text-org44c46fe">
<p>
Missing values can either have been omitted (due to information being non applicable or undisclosed) or simply be missing due to an error.<br />
</p>

<p>
When an observation with missing values is encountered you can:<br />
</p>
<ul class="org-ul">
<li><span class="underline">Replace</span> the missing value with a default one.<br /></li>
<li><span class="underline">Delete</span> it, if the number of missing values is too high.<br /></li>
<li><span class="underline">Keep</span> the missing values, since they might have a relation with frauds.<br />
<ul class="org-ul">
<li>In this case, it should be tested wether the missing info is related to a variable (e.g: two factor authentication) or not.<br />
If it&rsquo;s not the case, another of the two methods can be applied.<br /></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org07559e5" class="outline-4">
<h4 id="org07559e5">Outliers</h4>
<div class="outline-text-4" id="text-org07559e5">
<p>
Outliers are extreme values that are dissimilar to the rest of the population.<br />
Some of these values might be legitimate (or they might be the result of invalid observations).<br />
The methods to find them will be described in more depth later on (see the sections on <a href="#org80be186">Outliers detection</a>)<br />
</p>

<p>
They can be either:<br />
</p>
<ul class="org-ul">
<li><span class="underline">Univariate</span>, if they are outlying on one dimension.<br />
<b>Visual data exploration</b> is able to find out most of this kind of outliers, through different views (histograms, box plots).<br />
One additional method is looking at <b>Z-scores</b>, an index that measure how many standard deviations an observation lies away from the mean.<br /></li>

<li><span class="underline">Multivariate</span>, if they are outlying on multiple dimensions.<br />
Other methods (namely fitting regression lines and mahalanobis distance) are used to find this kind of outlying values.<br /></li>
</ul>
</div>

<div id="outline-container-orgc686a14" class="outline-5">
<h5 id="orgc686a14">Outlier treatment</h5>
<div class="outline-text-5" id="text-orgc686a14">
<p>
If an outlier is an invalid observation, you can treat it as a missing value.<br />
For valid observation, you can impose a range of values that do not modify your mean too much and put the outlier at one of the extremes.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org0afc3a5" class="outline-4">
<h4 id="org0afc3a5">When invalid data is not outlying</h4>
<div class="outline-text-4" id="text-org0afc3a5">
<p>
Sometimes, invalid values are not outliers though.<br />
</p>

<p>
For example: a customer with birth date 01/01/1980 and classified as a child is not an outlier (there might be many child customers and many customers born the same day), but it is clearly an invalid value.<br />
</p>

<p>
To remove such inconsistencies, a set of checks is made to find wether your data is <span class="underline">coherent</span> or not.<br />
</p>

<p>
To impose these checks you need the help of experts.<br />
</p>
</div>
</div>

<div id="outline-container-orgd1fc295" class="outline-4">
<h4 id="orgd1fc295">Conclusion on outliers and invalid values</h4>
<div class="outline-text-4" id="text-orgd1fc295">
<p>
Every single time you have to treat outliers and invalid values you must be really cautious when using the previous techniques, since these methods will impact the performance of your system (by removing the outliers, for example, you could lose some frauds).<br />
</p>
</div>
</div>

<div id="outline-container-org8e96c68" class="outline-4">
<h4 id="org8e96c68">Standardization</h4>
<div class="outline-text-4" id="text-org8e96c68">
<p>
Standardizatoin consists in <b>scaling variables to a similar range</b>. This step is <span class="underline">heavily affected by outliers</span>.<br />
You must always use common standardization methods.<br />
</p>
</div>
</div>

<div id="outline-container-orge989b3a" class="outline-4">
<h4 id="orge989b3a">Categorization</h4>
<div class="outline-text-4" id="text-orge989b3a">
<p>
To confront <i><a href="#orgdfa025d">categorical values</a></i> , they must first be <span class="underline">transformed</span> to reduce their number of categories.<br />
For example, IBANs and IPs could be categorized by their frequency (this process would make them comparable).<br />
</p>
</div>
</div>

<div id="outline-container-org9a2e50c" class="outline-4">
<h4 id="org9a2e50c">Variable Selection</h4>
<div class="outline-text-4" id="text-org9a2e50c">
<p>
A dataset is composed by hundreds of features.<br />
On a detection model, there are usually 10-15 of them.<br />
Which features to select in a model is a challenging task by itself.<br />
</p>
</div>

<div id="outline-container-orgc27d10d" class="outline-5">
<h5 id="orgc27d10d">Filters</h5>
<div class="outline-text-5" id="text-orgc27d10d">
<p>
Filters are used to <span class="underline">understand the informations each variable gives to the model</span>.<br />
They are standardized (pearson correlation, fisher score etc.), but they are not meant to be your only analysis step.<br />
</p>

<p>
Their main limitation is that you usually work variable by variable, without considering possible correlations between them.<br />
</p>
</div>
</div>

<div id="outline-container-orgb18891b" class="outline-5">
<h5 id="orgb18891b">Wrapper</h5>
<div class="outline-text-5" id="text-orgb18891b">
<p>
Instead of having to select my features at the beginning, I only give in input different set of features and see what the more promising sets are.<br />
</p>
</div>
</div>

<div id="outline-container-orgfe7bb3b" class="outline-5">
<h5 id="orgfe7bb3b">Principal Components Analysis</h5>
<div class="outline-text-5" id="text-orgfe7bb3b">
<p>
Try to reduce the number of variables by computing new variables, called <b>principal components</b>, that are <span class="underline">not correlated one another</span> and are <span class="underline">linear correlations of the original variables</span> .<br />
</p>

<p>
This transformation is extremely helpful for your analysis because they keep the informations of the variables while reducing the number of features to analyze.<br />
Moreover, even if they do not reduce the number of variables, they can bring out some more interesting features.<br />
</p>

<p>
PCA can help to make variables more robust.<br />
But the new variables made might be not as interpretable than the original ones.<br />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf1619e2" class="outline-3">
<h3 id="orgf1619e2">Descriptive analytics for fraud detection</h3>
<div class="outline-text-3" id="text-orgf1619e2">
<p>
<b>Unsupervised learning techniques</b> are used to <span class="underline">find anomalies</span> deviating from the norm. The main challenge is defining the norm; To do so, we use <b>descriptive analytics</b>.<br />
Two possibilities (with different levels of granularity):<br />
</p>
<ul class="org-ul">
<li>Behavior of the average customer (global perspective)<br /></li>
<li>average behavior of a given customer (local perspective)<br /></li>
</ul>

<p>
The <b>supervised learning technique</b> (based on <i>predictive analytics</i>), on the other hand, assumes you have labels available and can only detect known fraud patterns.<br />
Besides these limitations, they are usually useful to <span class="underline">understand the anomalies you found</span> on unsupervised analyses.<br />
</p>
</div>

<div id="outline-container-org7d21bd3" class="outline-4">
<h4 id="org7d21bd3">Relevant environments for Unsupervised learning</h4>
<div class="outline-text-4" id="text-org7d21bd3">
<p>
The use of Unsupervised learning techniques is particularly useful:<br />
</p>
<ul class="org-ul">
<li>In case of organizations <span class="underline">starting</span> to do fraud detection, with no data set available.<br /></li>
<li>When you have a dataset, but it is not labeled yet (the labeling process might take time).<br /></li>
<li>When fraud patterns change fast and are not reused commonly.<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org6585c44" class="outline-4">
<h4 id="org6585c44">Defining the norm</h4>
<div class="outline-text-4" id="text-org6585c44">
<p>
<i>The norm</i> <b>depends on the context</b> you are analyzing.<br />
It is a boundary (a threshold) that, due to the nature of frauds (continuously changing), will have to adapt.<br />
Moreover, the boundary is not a clear cut: some anomalies might be legit transaction, while some apparently normal transactions might be frauds.<br />
</p>

<p>
Even if you obtain good results on the tests, you must be able to make your system evolve - and the norm will change with it.<br />
</p>
</div>
</div>

<div id="outline-container-org80be186" class="outline-4">
<h4 id="org80be186">Graphical outliers detection</h4>
<div class="outline-text-4" id="text-org80be186">
<p>
Ideal tools to explore the data and get preliminary insights.<br />
</p>

<p>
It has some disadvantages though:<br />
</p>
<ul class="org-ul">
<li>Unformal.<br /></li>
<li>Not easily automatable.<br /></li>
<li>Limited to few dimensions.<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org40ed15e" class="outline-4">
<h4 id="org40ed15e">Statistical outliers detection</h4>
<div class="outline-text-4" id="text-org40ed15e">
<p>
Some statistical methods are applied to detect frauds:<br />
</p>
<ul class="org-ul">
<li><b>Z-score</b><br />
Seen before when we talked about <a href="#org07559e5">outliers</a>.<br /></li>
<li><b>Break point analysis</b><br />
Detects <span class="underline">intra-account</span> (in the same account) frauds<br /></li>
<li><b>Peer group analysis</b><br />
Detects <span class="underline">inter account</span> frauds<br /></li>
<li><b>Association rule</b><br />
Detects <span class="underline">single transaction</span> frauds<br />
Belongs mainly to the data mining world.<br /></li>
</ul>

<p>
These techniques are differentiated mainly by the granularity with wich you want to make the analysis.<br />
</p>
</div>

<div id="outline-container-orgf62f5f4" class="outline-5">
<h5 id="orgf62f5f4">Break point analysis</h5>
<div class="outline-text-5" id="text-orgf62f5f4">
<p>
Detects sudden changes in the account behavior (called <b>Break point</b>).<br />
The method is quite simple:<br />
</p>
<ol class="org-ol">
<li>define a fixed time window<br /></li>
<li>split the parts into &ldquo;old&rdquo; and &ldquo;new&rdquo;<br /></li>
<li>compare them<br />
This comparation is usually made with <i>t-score</i>, a metric that measures how much (and how fast) a value changed in a time window.<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org7da4a6b" class="outline-5">
<h5 id="org7da4a6b">Peer Group analysis</h5>
<div class="outline-text-5" id="text-org7da4a6b">
<p>
The main goal is to define the <span class="underline">peer group</span> (group of <b>similarly behaving accounts</b>) of an account.<br />
</p>

<p>
When the behavior of the target deviates from his peer group, an anomaly is detected.<br />
</p>

<p>
It is <span class="underline">more computational intensive</span> than break point analysis.<br />
</p>

<p>
Peer group analysis <b>can help with new accounts</b>, by approximating their spending profile with their peer group.<br />
</p>

<p>
The update of the patterns is usually done weekly or monthly, due to the fraudolent pattern changing in a couple of months.<br />
</p>
</div>


<div id="outline-container-org9d3a70b" class="outline-6">
<h6 id="org9d3a70b">Identifying, sizing and comparing a peer group</h6>
<div class="outline-text-6" id="text-org9d3a70b">
<p>
To identify a peer group we can use 2 methods:<br />
</p>
<ul class="org-ul">
<li>exploit business knowledge.<br /></li>
<li>Define a statistical metric to define the peers<br /></li>
</ul>

<p>
How many peers should you consider?<br />
</p>
<ul class="org-ul">
<li>few peers: more scalable (the performance loss is quadratic to the number of peers), but sensitive to noise.<br /></li>
<li>many peers: less scalable, but less sensitive to noide (a group too broad can lead to insensitivity to the deviations).<br /></li>
</ul>

<p>
How do you compare the behavior of the target w.r.t. the peers?<br />
</p>
<ul class="org-ul">
<li>statistical test<br /></li>
<li>distance metric<br /></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org4081a3b" class="outline-5">
<h5 id="org4081a3b">Break point analysis vs peer group analysis</h5>
<div class="outline-text-5" id="text-org4081a3b">
<p>
The two are complementary: you must use both at different times.<br />
E.g. for the holidays, break point analysis performs poorly: people spend more, resulting in an anomaly.<br />
With Peer group analysis, instead, all peers will shift to higher amounts, not causing an anomaly.<br />
</p>

<p>
Both these analyses, though, will <span class="underline">detect only local modifications</span> (local to an account/peer group).<br />
</p>
</div>
</div>

<div id="outline-container-orgbef104f" class="outline-5">
<h5 id="orgbef104f">Association rule analysis</h5>
<div class="outline-text-5" id="text-orgbef104f">
<p>
Detects frequent occurring <b>relationships between items</b>.<br />
An association rule is an implication X &rArr; Y, where both X and Y are subsets of data from the same set with <span class="underline">no common elements</span>.<br />
X is called <i>antecedent</i> and Y is called <i>consequent</i>.<br />
</p>

<p>
This kind of analysis was initially used for basket market<sup><a id="fnr.3" class="footref" href="#fn.3">3</a></sup> analysis, to understand which items were bough together.<br />
Supermarkets would decide which items to put near each other in an isle this way.<br />
</p>
</div>

<div id="outline-container-org68aa82d" class="outline-6">
<h6 id="org68aa82d">Support</h6>
<div class="outline-text-6" id="text-org68aa82d">
<p>
The frequency of an item set is measured by means of its <b>support</b>, which is the percentage of total transaction in the database that contains the item set.<br />
</p>
\begin{equation*}
support(x): \frac{\text{number of transactions that support } x}{\text{total number of transactions}}
\end{equation*}

<p>
Based on this function, we can identify the <b>frequent item set</b> , which will be then useful to derive the association rules.<br />
</p>
</div>
</div>

<div id="outline-container-orgd90c7ab" class="outline-6">
<h6 id="orgd90c7ab">Confidence</h6>
<div class="outline-text-6" id="text-orgd90c7ab">
<p>
Measures the <span class="underline">strength of the association</span>.<br />
It&rsquo;s defined as the probability of the rule consequent given the rule antecedent.<br />
</p>
\begin{equation*}
confidence(x \Rightarrow y): \frac{support(x \cup y)}{support (x)}
\end{equation*}
</div>
</div>
</div>
</div>
<div id="outline-container-org2f4dae1" class="outline-4">
<h4 id="org2f4dae1">Clustering</h4>
<div class="outline-text-4" id="text-org2f4dae1">
<p>
The goal of this analysis method is to <b>group the observations to find the norm</b>.<br />
These groups should maximize the <span class="underline">homogeneity between elements in the same group</span> and maximize the <span class="underline">etherogeneity between different groups</span>.<br />
</p>

<p>
The general idea is that the norm will be characterized by big dense clusters, while anomalies will be small clusters far from the normal ones.<br />
</p>
</div>

<div id="outline-container-orgd8789c3" class="outline-5">
<h5 id="orgd8789c3">Kinds of clusters</h5>
<div class="outline-text-5" id="text-orgd8789c3">
<p>
Clusters can be either:<br />
</p>
<ul class="org-ul">
<li>Hierarchical<br />
<ul class="org-ul">
<li>Agglomerative<br /></li>
<li>Divisive<br /></li>
</ul></li>
<li>Nonhierarchical<br />
<ul class="org-ul">
<li>k-means<br /></li>
<li>Self Organizing Maps<br /></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org7c30754" class="outline-5">
<h5 id="org7c30754">Measure the similarity of elements</h5>
<div class="outline-text-5" id="text-org7c30754">
<p>
To measure the similarity of elements <b>distance metrics</b> are used.<br />
There are many of them and it should be used whichever suits the dataset best.<br />
</p>

<p>
Euclidean distance is used commonly at the beginning for its simplicity.<br />
</p>
</div>
</div>

<div id="outline-container-orgdbd92e0" class="outline-5">
<h5 id="orgdbd92e0">Hierarchical clustering</h5>
<div class="outline-text-5" id="text-orgdbd92e0">
<p>
In <b>divisive clustering</b> techniques, the dataset is initially considered as a <span class="underline">unique cluster</span>, to be divided later on.<br />
In <b>agglomerative clustering</b> techniques, every element is considered as a <span class="underline">single point cluster</span>, to be aggregated with other clusters later on.<br />
</p>
</div>

<div id="outline-container-orgf7d1174" class="outline-6">
<h6 id="orgf7d1174">Distance between clusters</h6>
<div class="outline-text-6" id="text-orgf7d1174">
<p>
There are different ways to compute the <b>distance between clusters</b>, too.<br />
</p>
<ul class="org-ul">
<li><span class="underline">single linkage</span>: select the nearest points of two clusters and compute the distance.<br /></li>
<li><span class="underline">complete linkage</span>: select the farthest points of two clusters and compute the distance.<br /></li>
<li><span class="underline">average linkage</span>: average the distance of all the points of the two clusters.<br /></li>
<li><span class="underline">centroid linkage</span>: compute the distance of the centroid of the two clusters.<br /></li>
<li><span class="underline">\(d_{ward}\) distance</span>: compare the difference between the similarity of having the two clusters separated and having the two clusters joined.<br /></li>
</ul>

<p>
Depending on this selection, all your results will be different.<br />
</p>
</div>
</div>

<div id="outline-container-orga635627" class="outline-6">
<h6 id="orga635627">Select the number of clusters</h6>
<div class="outline-text-6" id="text-orga635627">
<p>
The selection of the number of clusters is <b>made through visualization</b>. Two techniques are used:<br />
</p>
<ul class="org-ul">
<li><span class="underline">dendograms</span>: temporal timeline of the construction of your clusters. You can cut the tree at the similarity level you want to have to generate your clusters.<br /></li>
<li><span class="underline">screen plot</span>: plot the distance at which clusters are merged and the number of clusters, then find the &ldquo;elbow&rdquo; of the curve: that point is where to stop.<br /></li>
</ul>
</div>
</div>

<div id="outline-container-orgf2aa98a" class="outline-6">
<h6 id="orgf2aa98a">Advantages and disadvantages</h6>
<div class="outline-text-6" id="text-orgf2aa98a">
<p>
Advantages:<br />
</p>
<ul class="org-ul">
<li>the number of clusters does not need to be specified<br /></li>
</ul>

<p>
Disadvantages:<br />
</p>
<ul class="org-ul">
<li>the interpretation of the clusters must be made with knowledge of the business logic.<br /></li>
<li>these techniques do not scale really well with large clusters.<br /></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgfdf4f51" class="outline-5">
<h5 id="orgfdf4f51">Nonhierarchical clustering</h5>
<div class="outline-text-5" id="text-orgfdf4f51">
</div>

<div id="outline-container-org633b108" class="outline-6">
<h6 id="org633b108">k-means</h6>
<div class="outline-text-6" id="text-org633b108">
<p>
Follow these steps:<br />
</p>
<ul class="org-ul">
<li>select k random observations (&ldquo;seeds&rdquo;) as &ldquo;centroids&rdquo; of the clusters you are going to create<br />
<ul class="org-ul">
<li>It is already evident a <i>problem</i>: how much is k? You have to choose it beforehand.<br /></li>
</ul></li>
<li>assign each observation to the cluster with the closest centroid<br /></li>
<li>when all observations are assigned, recalculate the centroids of each cluster and repeat the assignment.<br /></li>
<li>repeat until the centroids are stable or a limit is reached.<br /></li>
</ul>

<p>
This method is sensitive to outliers.<br />
</p>
</div>
</div>

<div id="outline-container-orgf06e9eb" class="outline-6">
<h6 id="orgf06e9eb">Self organizing maps</h6>
<div class="outline-text-6" id="text-orgf06e9eb">
<p>
Feed forward neural network with two layers (input and output).<br />
Allows to <span class="underline">visualize and cluster high dimensional nets on 2 layer neural networks</span>.<br />
</p>

<p>
Each input is connected to every possible output.<br />
When a training vector X is presented, it is compared to each neuron&rsquo;s training vector.<br />
The most similar neuron is the Best Matching Unit; It and its &ldquo;neighbors&rdquo; are &ldquo;adapted&rdquo;.<br />
The neighbors are defined with a function (\(h_{ci}\)).<br />
</p>

<p>
You&rsquo;re technically trying to update the network and aggregate the nearest points to the best matching unit.<br />
As always, you continue until your BMU remains stable or for a fixed number of iteration.<br />
</p>

<p>
They are quite helpful because:<br />
</p>
<ul class="org-ul">
<li>Once you have selected the output, they are basically automatic<br /></li>
<li>They allow you to represent the results you have obtained with two techniques:<br />
<ul class="org-ul">
<li>Unified distance Matrix (also called U-Matrix)<br />
visualizes the distance between a neuron and its neighbors; Large distances (darker colors) can be interpreted a cluster boundaries.<br /></li>
<li>Component plane<br />
visualizes the contribution of each input attribute to each neuron.<br /></li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org5dab944" class="outline-5">
<h5 id="org5dab944">Semi-Supervised clustering</h5>
<div class="outline-text-5" id="text-org5dab944">
<p>
Incorporates background knowledge to guide the clustering, by putting some constraints on how the clusters are formed.<br />
These can be put at different levels:<br />
</p>
<ul class="org-ul">
<li>observation-level constraints: put constraints between single entities (these entities must/mustn&rsquo;t link together)<br /></li>
<li>Cluster level constraints: impose a certain level of similarity between the clusters<br /></li>
<li>other constraints<br /></li>
</ul>
</div>
</div>

<div id="outline-container-orgd51365c" class="outline-5">
<h5 id="orgd51365c">One-class SVM</h5>
<div class="outline-text-5" id="text-orgd51365c">
<p>
Try to maximize the distance between norm and anomalies: try to separate theme with a linear hyperplane (the anomalies are then the ones near the origin of your graph).<br />
</p>
</div>
</div>

<div id="outline-container-orgb3124c8" class="outline-5">
<h5 id="orgb3124c8">Evaluation of clustering solutions</h5>
<div class="outline-text-5" id="text-orgb3124c8">
<p>
There&rsquo;s <span class="underline">no universal criterion</span> to evaluate which clustering is better, but a commonly used solution is the <b>sum of Squared Errors</b>.<br />
</p>

<p>
Another one is to analyze them graphically and confront them.<br />
</p>

<p>
Finally, another one is to train a supervised learning method on the basis of the results of the unsupervised learning one.<br />
The unsupervised one will tell you the clustering, the supervised might lead you to the reasons behind those clusters.<br />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org16a44fc" class="outline-3">
<h3 id="org16a44fc">Predictive analytics for fraud detection</h3>
<div class="outline-text-3" id="text-org16a44fc">
<p>
The aim of these analytics is to build a model to <b>predict a variable of interest</b> (it will be called <span class="underline">target variable</span> from now on).<br />
The real value that the target assumes from our prediction is then used to steer the learning process.<br />
</p>

<p>
This target variable is usually a fraud indicator (so the resulting model is trained to recognize frauds); This means it is inherently hard to obtain and determine.<br />
</p>

<p>
Two kinds of predictive analysis can be distinguished depending on the type of variable we want to predict:<br />
</p>
<ul class="org-ul">
<li><b>Regression</b>: used for <span class="underline">continuous</span> variables (with a possibly unlimited set of values).<br /></li>
<li><b>Classification</b>: used for <span class="underline">categorical</span> variables (but with a limited set of values).<br /></li>
</ul>
</div>

<div id="outline-container-orgb9ee66b" class="outline-4">
<h4 id="orgb9ee66b">Linear regression</h4>
<div class="outline-text-4" id="text-orgb9ee66b">
<p>
One of the many kinds of regression.<br />
</p>

<p>
The target variable is seen as a combination of <b>explanatory variables</b>, with a certain weigth \(\beta_{i}\) assigned to each of them that measures the impact of the explanatory variable on the target variable.<br />
</p>

<p>
These parameters \(\beta_{i}\) must be estimated through the <span class="underline">minimization of squared error function</span>, a function that gives you an indication of how wrong your prediction was w.r.t. the actual value of the target variable.<br />
</p>

<p>
It has some limitation though:<br />
</p>
<ul class="org-ul">
<li>The target variable is considered to be a continuous variable normally distributed, but it might not be (for example, it might be a boolean variable with a bernoully distribution)<br /></li>
<li>We might not have enough informations about the variable to move it to a continuous range (in the bernoulli case covered above, we could interpret it as a probability if we had enough informations about it).<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org35c2369" class="outline-4">
<h4 id="org35c2369">Logistic regression</h4>
<div class="outline-text-4" id="text-org35c2369">
<p>
Another kind of regression.<br />
</p>

<p>
A <b>logistic regression</b> is just the <span class="underline">combination of a linear regression and a bounding function</span> (a function that limits the prediction values to a smaller interval).<br />
</p>

<p>
The parameters of a logistic regression model are estimated using a maximum likelihood optimization.<br />
</p>

<p>
With a logistic regression model we are able to predict boolean variables, such as a variable that represents the question &ldquo;<i>is this observation fraudolent?</i>&rdquo;.<br />
</p>

<p>
To decide wether a response is positive or not we use an <b>activation function</b>, that maps our obtained prediction (already bounded between 0 and 1 thanks to the bunding function) to a positive or a negative answer.<br />
</p>

<p>
By training our model through logistic regression on a labeled set, we can find the combinatoin of variables that gives us a response to the question accurately enough.<br />
</p>
</div>
</div>

<div id="outline-container-org6e4bb52" class="outline-4">
<h4 id="org6e4bb52">Decision trees</h4>
<div class="outline-text-4" id="text-org6e4bb52">
<p>
A classification method of training.<br />
We use a <b>tree like structure</b> to <span class="underline">label our observations</span>.<br />
In the leaf nodes you have the assignment of labels (fraud/not fraud).<br />
In each node you have a testing condition to move to lower nodes.<br />
</p>

<p>
Decision trees are defined by three &ldquo;decisions&rdquo; (<i>sorry for the play on words</i>):<br />
</p>
<ol class="org-ol">
<li><span class="underline">splitting decision</span> (which variable do we split? at which value?)<br /></li>
<li><span class="underline">stopping decision</span> (when do we add a leaf node?)<br /></li>
<li><span class="underline">assignment decision</span> (which label do you assign to the group in the current leaf?)<br /></li>
</ol>
</div>

<div id="outline-container-orgc88faf2" class="outline-5">
<h5 id="orgc88faf2">Splitting decision</h5>
<div class="outline-text-5" id="text-orgc88faf2">
<p>
First of all, we define <b>impurity</b> as the diversity on our dataset.<br />
When our dataset is composed of half/half (of a specific condition), we have maximal impurity.<br />
When out dataset is composed of only one kind, we have minimal impurity.<br />
</p>

<p>
The variable to do the splitting decision on is chosen by looking at the <span class="underline">highest reduction of impurity</span>.<br />
</p>
</div>
</div>

<div id="outline-container-org9cc86fb" class="outline-5">
<h5 id="org9cc86fb">Stopping decision</h5>
<div class="outline-text-5" id="text-org9cc86fb">
<p>
If we split too much, we tend to <span class="underline">overfit</span> (consider, other than the data we are interested in, also noise).<br />
</p>

<p>
To avoid overfitting and find the best spot to stop splitting, our dataset should be divided in:<br />
</p>
<ul class="org-ul">
<li>training set (on which we make the splitting decisions)<br /></li>
<li>validation set (a labeled sample to monitor the misclassification error)<br /></li>
<li>testing set (a independent sample to test our decision tree)<br /></li>
</ul>

<p>
You can then plot the misclassification error on the validation set wrt the number of tree nodes.<br />
Once the misclassification error is at its minimum, we can then say to stop the creation of new nodes at that point and, instead, start the creation of leaves.<br />
</p>
</div>
</div>

<div id="outline-container-org87958c2" class="outline-5">
<h5 id="org87958c2">Advantages</h5>
<div class="outline-text-5" id="text-org87958c2">
<p>
Decision trees are useful because they are <span class="underline">easy to build</span>.<br />
Moreover, they are a <span class="underline">white-box method</span>: you can convert a decision tree into a set of <a href="#orgb4d7c59">decision rules</a> easily (the ones that fraud detection expert based systems use), since you have the conditions on each node.<br />
</p>
</div>
</div>

<div id="outline-container-org7d8e495" class="outline-5">
<h5 id="org7d8e495">Disadvantages</h5>
<div class="outline-text-5" id="text-org7d8e495">
<p>
Decision trees tends to overfit the data, but we could use cross validation to reduce this.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org921b1bb" class="outline-4">
<h4 id="org921b1bb">Regression trees</h4>
<div class="outline-text-4" id="text-org921b1bb">
<p>
You can also predict continuous targets with decision trees (for example, you can give the <i>probability</i> of a transaction being a fraud) and transform them into a <span class="underline">regression method</span>.<br />
</p>
</div>
</div>

<div id="outline-container-org6264979" class="outline-4">
<h4 id="org6264979">Neural Networks</h4>
<div class="outline-text-4" id="text-org6264979">
<p>
Generalization of existing statistical models.<br />
The basic element of a Neural network is the <b>neuron</b>: it takes an input, multiplies it by a weight and puts it into a <i>transformation function</i> (can be a logistic regression).<br />
</p>
</div>

<div id="outline-container-orgc3185df" class="outline-5">
<h5 id="orgc3185df">Layers</h5>
<div class="outline-text-5" id="text-orgc3185df">
<p>
The neural networks presented during lesson are composed of 3 layers:<br />
</p>
<ul class="org-ul">
<li><span class="underline">Input layer</span><br /></li>
<li><span class="underline">Hidden layer</span>, which combines the inputs into features.<br /></li>
<li><span class="underline">Output layer</span>, which linearly transforms the features given by the hidden layer.<br /></li>
</ul>

<p>
Usually, each layer has <span class="underline">its own transformation function</span> (common to all the nodes in the layer).<br />
Neural networks can be used both as a <span class="underline">regression analysis</span> method and a <span class="underline">classification analysis</span> method, depending on the transformation function used in the output layer.<br />
</p>
</div>
</div>

<div id="outline-container-orgceb5d74" class="outline-5">
<h5 id="orgceb5d74">Weigth learning</h5>
<div class="outline-text-5" id="text-orgceb5d74">
<p>
To optimize a neural network, we use an iterative algorithm that optimizes a <b>cost function</b> to find the best assignments to the weights of each neuron.<br />
</p>

<p>
The cost function used might have <span class="underline">multiple minimas</span>, that could get you stuck on a result that is not optimal.<br />
To avoid this, we usually do the optimization with <span class="underline">multiple initial random set of weigths</span> and select only the one with the global minimum after some steps.<br />
</p>
</div>
</div>

<div id="outline-container-org533f322" class="outline-5">
<h5 id="org533f322">How many hidden neurons?</h5>
<div class="outline-text-5" id="text-org533f322">
<p>
The number of hidden neurons to use depends on the non linearity of the dataset.<br />
The more complex are the patterns we need to model, the more neurons we will need.<br />
</p>

<p>
The procedure to select the number of neurons is basically the same seen to select the number of nodes in Decision trees (called, in that context, the <a href="#org9cc86fb">stopping decision</a>):<br />
</p>
<ol class="org-ol">
<li>Split the data into <span class="underline">training</span>, <span class="underline">validation</span> and <span class="underline">test</span> set<br /></li>
<li>train multiple neural networks on the training set with different numbers of neurons.<br /></li>
<li>measure the performance of each network on the validation set.<br /></li>
<li>choose the most performant neural network<br /></li>
<li>measure its actual performance on the independent test set.<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgd2bb1ab" class="outline-5">
<h5 id="orgd2bb1ab">The overfitting problem</h5>
<div class="outline-text-5" id="text-orgd2bb1ab">
<p>
To avoid overfitting, we can use two techniques<br />
</p>
<ul class="org-ul">
<li><span class="underline">Weigth regularization</span>: we put an upper bound on the weigths of the neural net.<br /></li>
<li>The usual method: we estimate the weigth and use independent data sets of the same pool to decide when to stop training to avoid overfitting.<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org9863f7c" class="outline-5">
<h5 id="org9863f7c">Neural Networks lack interpretability</h5>
<div class="outline-text-5" id="text-org9863f7c">
<p>
It is extremely difficult to find out why a certain output is given from certain inputs, which makes the <span class="underline">extraction of rules complex</span>.<br />
</p>

<p>
They are, though, generally more performant than the other methods seen.<br />
</p>
</div>

<div id="outline-container-org40d1be3" class="outline-6">
<h6 id="org40d1be3">Variable selection in Neural Networks</h6>
<div class="outline-text-6" id="text-org40d1be3">
<p>
To find out which variables contribute actively to the outputs of the neural network, we must visualize the interaction between the inputs (our variables, like &ldquo;the age of the customer&rdquo; and &ldquo;the amount claimed by the insurance company&rdquo;) and the rest of the network.<br />
</p>

<p>
To do so, we use <span class="underline">Hinton Diagrams</span>, where we visualize the weigths between inputs and hidden neurons as squares and interpret them.<br />
</p>

<p>
Another way is <span class="underline">Backward variable selection</span>:<br />
We build a neural network with all the variables in input, then we recreate the network with one variable less to see how much the performance is impacted (those variables that don&rsquo;t hinder the performance of the network can be removed, since they add complexity).<br />
</p>
</div>
</div>

<div id="outline-container-orgb01c337" class="outline-6">
<h6 id="orgb01c337">Extracting rules from Neural Networks</h6>
<div class="outline-text-6" id="text-orgb01c337">
<p>
To extract the rules to be fed to a rule based engine, we can use two techniques:<br />
</p>
<ul class="org-ul">
<li><span class="underline">Decompositional rule extraction</span>, where we find the activation values of the hidden neurons (with clustering, for example) and join them in a single boolean rule.<br /></li>
<li>Pedagogical rule extraction: use the labels produced by the Neural Network as the training set for a white box method (like decision trees), where the rules are simpler to extract.<br /></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org2c24d1c" class="outline-5">
<h5 id="org2c24d1c">Two stage model setup</h5>
<div class="outline-text-5" id="text-org2c24d1c">
<p>
Instead of directly using a Neural network, we can estimate a simpler model with a more interpretable method (like linear/logistic regression) and, then, use a neural network to predict the errors made by the model and adjust the parameters of the linear model.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org8868c33" class="outline-4">
<h4 id="org8868c33">Support Vector Machines</h4>
<div class="outline-text-4" id="text-org8868c33">
<p>
Based on linear programming<sup><a id="fnr.4" class="footref" href="#fn.4">4</a></sup> (define an objective function and put some constraints on it).<br />
It&rsquo;s a <span class="underline">classification method</span>, but it can also be applied as a regression method.<br />
</p>
</div>

<div id="outline-container-orga0ebaa7" class="outline-5">
<h5 id="orga0ebaa7">Benefits</h5>
<div class="outline-text-5" id="text-orga0ebaa7">
<p>
In linear programming, it&rsquo;s <span class="underline">easy to introduce business knowledge</span> (simply add constraints).<br />
</p>
</div>
</div>
<div id="outline-container-org15a1eef" class="outline-5">
<h5 id="org15a1eef">Problem</h5>
<div class="outline-text-5" id="text-org15a1eef">
<ol class="org-ol">
<li>It can estimate <span class="underline">multiple optimal decision boundaries</span> for a linear separable case.<br />
We can avoid this problem by selecting the boundary that is maximally distant from the two classes.<br /></li>

<li>The system might be <b>non-separable</b> (we might not be able to find a linear boundary between two classes).<br />
In this case, we can introduce a <span class="underline">misclassification error</span>, which allows for wrong classification labels to happen.<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgf287551" class="outline-5">
<h5 id="orgf287551">Rule extraction and Variable selection</h5>
<div class="outline-text-5" id="text-orgf287551">
<p>
To extract variables and rules from SVMs, we can use the same approaches seen for Neural Networks:<br />
</p>
<ul class="org-ul">
<li>for <span class="underline">variable selection</span> , the <a href="#org40d1be3">backward variable selection</a> procedure can be used to reduce the input variables.<br /></li>
<li>for <span class="underline">rule extraction</span> , the SVM can be interpreted as a neural network and the <a href="#orgb01c337">same methods</a> can be applied.<br /></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgec2b226" class="outline-4">
<h4 id="orgec2b226">Ensemble methods</h4>
<div class="outline-text-4" id="text-orgec2b226">
<p>
Ensembe methods aim at estimating <b>multiple analytical models</b> instead of only one; The models created can then be used to cover different parts of the data input.<br />
</p>
</div>

<div id="outline-container-orgbcbfa5f" class="outline-5">
<h5 id="orgbcbfa5f">Bagging</h5>
<div class="outline-text-5" id="text-orgbcbfa5f">
<p>
The Baggin method is an ensemble method. It consists of two steps:<br />
</p>
<ol class="org-ol">
<li>Take N samples from your dataset.<br /></li>
<li>Build a model (also called <span class="underline">classifier</span> ) for each of these samples.<br /></li>
</ol>

<p>
A <span class="underline">classification</span> model is then built by letting the classifiers &ldquo;vote&rdquo; on the label to give.<br />
A <span class="underline">regression</span> model is built by averaging the outcome of the N models.<br />
</p>
</div>
</div>

<div id="outline-container-orgf85c5af" class="outline-5">
<h5 id="orgf85c5af">Boosting</h5>
<div class="outline-text-5" id="text-orgf85c5af">
<p>
The Boosting method is an ensemble method. It estimates multiple models using a <span class="underline">weighted data sample</span>.<br />
</p>

<p>
The weights applied on the data change according to the classification errors made by the models, to allow difficult observations to get more attention.<br />
But this calls for a <b>drawback</b>: the models might become overfitted on the difficult observations.<br />
</p>

<p>
The final model used is a combination of all the individual models.<br />
</p>
</div>
</div>

<div id="outline-container-orge707e1d" class="outline-5">
<h5 id="orge707e1d">Random Forest&#xa0;&#xa0;&#xa0;<span class="tag"><span class="missing_informations">missing_informations</span></span></h5>
<div class="outline-text-5" id="text-orge707e1d">
<p>
We create a &ldquo;forest&rdquo; of decision trees, with random splitting decision variables for each tree.<br />
</p>

<p>
It&rsquo;s not clear how the final model is built from the set of decision trees.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org94faf77" class="outline-4">
<h4 id="org94faf77">Evaluating a fraud detection model</h4>
<div class="outline-text-4" id="text-org94faf77">
<p>
Two key decisions determine the effectiveness of the predictive models shown above:<br />
</p>
<ul class="org-ul">
<li>how to split the data set<br /></li>
<li>how we choose our performance metrics.<br /></li>
</ul>
</div>

<div id="outline-container-org4e593d3" class="outline-5">
<h5 id="org4e593d3">Splitting the data set</h5>
<div class="outline-text-5" id="text-org4e593d3">
<p>
The training data set and the test dataset must be completely separated.<br />
The decision on how we split the set <b>depends on the size</b> of the dataset itself.<br />
</p>

<p>
When present, the validation sample (seen for <a href="#org9cc86fb">decision trees</a> and <a href="#org533f322">neural networks</a>) should be separated, too, but the requirement is less strict.<br />
</p>

<p>
Sometimes, having the <span class="underline">same percentage of fraudsters</span> in each set can be useful; Such split-up is called a <b>stratified split-up</b>.<br />
</p>
</div>

<div id="outline-container-org248f6f1" class="outline-6">
<h6 id="org248f6f1">Small data sets</h6>
<div class="outline-text-6" id="text-org248f6f1">
<p>
When the data set is not big enough, two methods can be adopted to make the split:<br />
</p>
<ul class="org-ul">
<li><b>Cross-validation</b>:<br />
The data is split in K groups, then the model is trained on K-1 groups and tested on the remaining group.<br />
The process is then repeated for every possible validation group, resulting in K <span class="underline">performance estimates</span> (<i>aren&rsquo;t they also different models?</i>).<br /></li>
<li><b>Leave-one-out cross validation</b>:<br />
Every observation is left out in turn and a model is made from the remaining ones.<br /></li>
</ul>

<p>
The selection of the model can then be performed in different ways:<br />
</p>
<ul class="org-ul">
<li>randomly (common for leave-one-out cross validation, since every model changes by only an observation)<br /></li>
<li>a final model on all observation is built (taking into consideration the performances coming out of the cross validation process)<br /></li>
<li>an ensemble model is built with a voting procedure (similarly to what we have seen for <a href="#orgbcbfa5f">bagging ensemble models</a>)<br /></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgc3cdf70" class="outline-5">
<h5 id="orgc3cdf70">Performance metrics</h5>
<div class="outline-text-5" id="text-orgc3cdf70">
<p>
The main performance metrics used to evaluate our analytical model are:<br />
</p>
<ul class="org-ul">
<li><b>classification accuracy</b> : \(\frac{\text{true positive } + \text{ true negative}}{\text{true positive }+\text{ false positive }+\text{ false negative }+\text{ true negative}}\), or the percentage of correctly classified observations.<br /></li>
<li><b>classification error</b> : \(\frac{\text{false positive } + \text{ false negative}}{\text{true positive }+\text{ false positive }+\text{ false negative }+\text{ true negative}}\), or the percentage of wrongly classified observations.<br /></li>
<li><b>sensitivity</b> (also called recall or hit rate) : \(\frac{\text{true positive}}{\text{true positive }+\text{ false negative}}\), or the percentage of fraudsters correctly labeled.<br /></li>
<li><b>specificity</b> : \(\frac{\text{true negative}}{\text{false positive }+\text{ true negative}}\), or the percentage of non-fraudsters correctly labeled.<br /></li>
<li><b>precision</b> : \(\frac{\text{true positive}}{\text{false positive }+\text{ true positive}}\), or the percentage of labeled fraudsters that are actually fraudsters.<br /></li>
</ul>
</div>
</div>


<div id="outline-container-org0889f26" class="outline-5">
<h5 id="org0889f26">Managing skewed datasets</h5>
<div class="outline-text-5" id="text-org0889f26">
<p>
With a skewed<sup><a id="fnr.2.100" class="footref" href="#fn.2">2</a></sup> dataset it might become difficult to make a valid model due to the missing observations labeled as frauds.<br />
Two transformations can be made to the dataset to make it less skewed:<br />
</p>
<ul class="org-ul">
<li><b>Oversampling</b> : replicate frauds to make the distribution less skewed.<br /></li>
<li><b>Undersampling</b> : remove some observations that aren&rsquo;t frauds.<br /></li>
</ul>

<p>
The two can also be combined, but usually undersampling yelds better results (since we don&rsquo;t put in the set forged observations).<br />
</p>

<p>
In general, it&rsquo;s suggested to <b>stay as close as possible to the original distribution</b> to avoid unnecessary bias.<br />
</p>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org212c2fc" class="outline-2">
<h2 id="org212c2fc">Mobile Forensics&#xa0;&#xa0;&#xa0;<span class="tag"><span class="guest_lecture">guest_lecture</span></span></h2>
<div class="outline-text-2" id="text-org212c2fc">
<p>
Mobile devices use has increased between people and, in turn, mobile forensics investigation has gained importance.<br />
</p>

<p>
Mobile forensics is a branch of digital forensics, related to the recovery of digital evidence from a mobile device under <b>forensically sound conditions</b>.<br />
</p>
</div>

<div id="outline-container-orgab8ff45" class="outline-3">
<h3 id="orgab8ff45">Forensical soundness</h3>
<div class="outline-text-3" id="text-orgab8ff45">
<p>
Forensically sound is a term used to justify the use of particular forensic technology or methodology.<br />
</p>

<p>
It doesn&rsquo;t have a specific definition (&ldquo;<i>it depends</i>&rdquo;), but we can say that a method is forensically sound when it <span class="underline">doesn&rsquo;t alter or destroy the evidence</span> and has been shown to be <span class="underline">consistently reliable</span>.<br />
</p>

<p>
For example, in computer forensics we use various ways to avoid altering the data on the system:<br />
On computers you are typically able to remove the hard drive, and if this option is not available you usually have a way to boot a live distribution to mount the hard drive on a read-only way (from a phisical perspective, we are able to have a 100% forensically sound approach).<br />
</p>

<p>
On mobile devices, this is extremely difficult to do, mostly because we are <span class="underline">limited in the use of our phone</span> (unless we are root, which is usually not the case) and because most elements (like memory) is soldered.<br />
Moreover, the memory in the phone is most of the time encrypted on some key stored on the motherboard or another chipset (see iOS devices and their enclave).<br />
</p>

<p>
When the acquisition of data is not possible without changing the configuration of the device (even booting the phone might change some things), the <span class="underline">procedure must be documented</span> and the <span class="underline">changes must be tested beforehand</span>.<br />
</p>
</div>

<div id="outline-container-org8db5431" class="outline-4">
<h4 id="org8db5431">Low Level Exploits</h4>
<div class="outline-text-4" id="text-org8db5431">
<p>
In some phones, it&rsquo;s possible to obtain the best acquisition (full, unaltered) with <b>low level exploits</b>, which allow us to <span class="underline">obtain root privileges before the phone boots</span>; Such acquisitions are the nearest to forensically sound in mobile forensics.<br />
It&rsquo;s more common on Android devices.<br />
</p>
</div>
</div>

<div id="outline-container-orgf9eee11" class="outline-4">
<h4 id="orgf9eee11">Documentation is key</h4>
<div class="outline-text-4" id="text-orgf9eee11">
<p>
The key to forensic soundness is <b>documentation</b>. The acquisition process should change the original evidence as little as possible and any changes should be documented and assessed.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org13ed2b0" class="outline-3">
<h3 id="org13ed2b0">Challenges of mobile forensics</h3>
<div class="outline-text-3" id="text-org13ed2b0">
<p>
In the mobile world we have a <b>big market fragmentation</b>, with new devices added daily.<br />
</p>

<p>
Each and every device uses some kind of chipset (qualcomm, exynos, kirin etc.), and most exploits are available at the chipset level (sometimes also on software level, but rarely), which means we have to <b>undestand exactly the carachteristics of the device</b> in front of us.<br />
</p>

<p>
Digital forensic analysts must also <b>overcome difficult security measures</b> (e.g: limited tries pin codes) brought up by the phone manufacturers, sometimes without the help of the incrimined person (s/he might be dead or unwilling to help).<br />
</p>

<p>
Moreover, the <b>data of interest</b> for forensic analysts has <b>expanded to multiple applications</b> (where previously it was mostly sms and, sometimes, images).<br />
The <b>amount of memory</b> to analyze in a smartphone has increased a lot (up to 500 gigs as of now) which implies the need for new analysis methodologies (e.g: AI recognition).<br />
</p>

<p>
Finally, for some apps the data is stored not only on the phone but on the <b>cloud</b>, too, and to analyze those data you need access to the cloud account of the person, which:<br />
</p>
<ol class="org-ol">
<li>is difficult to do<br /></li>
<li>you must first get permission to do it<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgd72be38" class="outline-3">
<h3 id="orgd72be38">Operating system diversity</h3>
<div class="outline-text-3" id="text-orgd72be38">
<p>
In mobile, the most used OSes nowadays are <span class="underline">Android</span> and <span class="underline">iOS</span>, with the only additional (still being developed) OS being <span class="underline">KaiOS</span>.<br />
In Italy we use mostly Android, while in America iOS is dominant.<br />
As you can understand, most of the commercial companies are US based.<br />
</p>
</div>

<div id="outline-container-orga93b43d" class="outline-4">
<h4 id="orga93b43d">Android versions diversity</h4>
<div class="outline-text-4" id="text-orga93b43d">
<p>
Android has multiple versions still being used by a wide audience, with the security patches providing an additional layer of diversification.<br />
</p>

<p>
When it comes to software level exploits, having knowledge of the version and which security patch is applied on the phone is the key point to choose your extraction methodology.<br />
</p>
</div>
</div>

<div id="outline-container-org97f4484" class="outline-4">
<h4 id="org97f4484">iOS versions diversity</h4>
<div class="outline-text-4" id="text-org97f4484">
<p>
Since iOS forces the updates on the phones, there&rsquo;s not the same diversity that you can find in the android market share.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org89e0b59" class="outline-3">
<h3 id="org89e0b59">Guidelines to follow</h3>
<div class="outline-text-3" id="text-org89e0b59">
<p>
There are various guidelines documented online to follow.<br />
The one we will analyze is <a href="https://drive.google.com/file/d/1sVko_Uo7o6iootWwn9IoLJ3mrMVXqTDg/view">one from SWGDE</a>.<br />
</p>

<p>
It&rsquo;s organized in sections:<br />
</p>
</div>

<div id="outline-container-org743e366" class="outline-4">
<h4 id="org743e366">Evidence collection and preservation</h4>
<div class="outline-text-4" id="text-org743e366">
<p>
Tipically done by law enforcement.<br />
</p>
</div>

<div id="outline-container-org99a4df6" class="outline-5">
<h5 id="org99a4df6">Preparation</h5>
<div class="outline-text-5" id="text-org99a4df6">
<p>
You need to have the proper tools to do and document the steps you will take, and you need to have proper legal authority to collect the evidence<br />
</p>
</div>
</div>

<div id="outline-container-orgf57064c" class="outline-5">
<h5 id="orgf57064c">Documentation</h5>
<div class="outline-text-5" id="text-orgf57064c">
<p>
Take notes of the collection location and the device state and characteristics at the time of collection.<br />
You have different things to identify and take as evidence, such as cables, phone boxes etc.<br />
</p>
</div>
</div>

<div id="outline-container-org08f44aa" class="outline-5">
<h5 id="org08f44aa">What to do first</h5>
<div class="outline-text-5" id="text-org08f44aa">
<p>
Based on the state of the phone and its type, you have two options for the <b>preservation process</b> (what to do to preserve the integrity of the evidence and to work in a <span class="underline">forensically sound</span> way):<br />
</p>
<ul class="org-ul">
<li>If on:<br />
<ul class="org-ul">
<li>Keep it on. Making it turn off will almost certainly encrypt the phone<br /></li>
<li>If the phone is on and the passcode was not inserted since boot, the phone won&rsquo;t have unencrypted its data and won&rsquo;t have used its ram (true mostly for iOS).<br /></li>
<li>If we can access the settings, engage airplane mode, disable wifi, disable bluetooth and extend the display auto-lock.<br /></li>
<li>If the system cannot be accessed, put it in a faraday bag to <span class="underline">avoid outside connections</span> from happening.<br /></li>
</ul></li>
<li>If off:<br />
<ul class="org-ul">
<li>Don&rsquo;t turn it on<br /></li>
<li>Remove the battery if possible<br /></li>
</ul></li>
<li>In both cases, collect the device identifiers.<br /></li>
</ul>
</div>
</div>

<div id="outline-container-orgb1da896" class="outline-5">
<h5 id="orgb1da896">Check periferals</h5>
<div class="outline-text-5" id="text-orgb1da896">
<p>
Check for any paired or linked devices, which might lead to backups or additional informations.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org5de243a" class="outline-4">
<h4 id="org5de243a">Evidence Handling</h4>
<div class="outline-text-4" id="text-org5de243a">
<p>
The steps to extract the data from your device without loss of digital or physical data (e.g: fingerprints).<br />
</p>
</div>

<div id="outline-container-orgd61523a" class="outline-5">
<h5 id="orgd61523a">Access devices</h5>
<div class="outline-text-5" id="text-orgd61523a">
<p>
Frequently, phones can be unlocked if you have access to a safe place of the owner or another smart tool (a smartwatch) or the body of the person itself.<br />
Be careful: don&rsquo;t try to guess the password, which might call procedures of the phone to provide additional security measures (like formatting the data partition of the phone).<br />
</p>
</div>
</div>

<div id="outline-container-orgd0ad772" class="outline-5">
<h5 id="orgd0ad772">Devices powered on and unlocked</h5>
<div class="outline-text-5" id="text-orgd0ad772">
<p>
Document as much as possible the content of the phone (also by taking pictures) without locking it accidentally.<br />
</p>

<p>
If the phone is an organization&rsquo;s device, an MDM (mobile device management) system might be in place which would require to seek help from the system administrator of the organization to extract data.<br />
</p>
</div>
</div>

<div id="outline-container-orgba86c40" class="outline-5">
<h5 id="orgba86c40">Encryption</h5>
<div class="outline-text-5" id="text-orgba86c40">
<p>
Most of the devices nowadays use some form of encryption.<br />
iOS devices (mostly, but not only) have backup passwords.<br />
There are ways to bypass and reset these kind of passwords but this modifies the content of the phone, and as such must be documented and extensively tested.<br />
</p>
</div>
</div>

<div id="outline-container-org0bcb48e" class="outline-5">
<h5 id="org0bcb48e">Network Isolation</h5>
<div class="outline-text-5" id="text-org0bcb48e">
<p>
Any kind of connection can be dangerous for the phone.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org3985924" class="outline-4">
<h4 id="org3985924">Evidence acquisition</h4>
<div class="outline-text-4" id="text-org3985924">
</div>
<div id="outline-container-orgd92f4d5" class="outline-5">
<h5 id="orgd92f4d5">Preparation</h5>
<div class="outline-text-5" id="text-orgd92f4d5">
<p>
Prepare all the software applications, cables etc. to perform the acquisition.<br />
</p>

<p>
There are various tools (and there is a <a href="https://www.nist.gov/itl/ssd/software-quality-group/computer-forensics-tool-testing-program-cftt/cftt-technical/mobile">website</a>) to test and review various type of forensics tools.<br />
The number of tool vendors available is limited nowadays, and there&rsquo;s no single tool perfect for all scopes: we have to <span class="underline">use different tools for different devices</span>, and sometimes manual investigation is mandatory.<br />
</p>

<p>
Sometimes, exploit are not available at the time of the analysis, but they might become available later on (for example, Epifani told us about a time when the exploit was made available during a trial and they were able to analyze the phone at that point).<br />
</p>
</div>

<div id="outline-container-org1bb6f45" class="outline-6">
<h6 id="org1bb6f45">Tools for law enforcement and acquisition services</h6>
<div class="outline-text-6" id="text-org1bb6f45">
<p>
Some of these tools are only <b>meant for law enforcement</b>.<br />
Most of the times though, police analysts use unlocking and decryption mechanisms <b>provided as a service</b>, where you send the phone to a lab and they unlock it through zero-days exploit that are not yet available to the public (and not yet tested).<br />
</p>

<p>
This methods must be carefully reviewed by a court of law, since the methods used are not reliable.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgc6be27e" class="outline-5">
<h5 id="orgc6be27e">Device identification</h5>
<div class="outline-text-5" id="text-orgc6be27e">
<p>
To identify a device, you can use:<br />
</p>
<ul class="org-ul">
<li>its <b>IMEI</b>, a number to univocally identify it worldwide<br /></li>
<li>the model number<br /></li>
<li>the serial number<br /></li>
</ul>

<p>
Sometimes, the IMEI is written on the back of the phone, sometimes it is written in the simcard tray, sometimes on the packaging box of the phone, but it should always be accessible (on an unlocked and functioning device) by dialing <code>*#06#</code>.<br />
</p>

<p>
Once the IMEI is identified, you need to search and understand what characteristics the phone has based on it. You can use <a href="https://imei.info">this website</a> to find informations about it.<br />
Most importantly, the chipset must be known to understand which tool/technique to use to extract data from the phone.<br />
</p>

<p>
Another option is to <span class="underline">check the coverage of the warranty</span> of the phone (mainly for apple devices) through the serial number. This way you can undestrand wether the phone was recently purchased and, based on the informations acquired, you can ask apple (as a public prosecutor) to provide you informations about that phone.<br />
</p>
</div>
</div>

<div id="outline-container-orgc102d81" class="outline-5">
<h5 id="orgc102d81">Extraction methods</h5>
<div class="outline-text-5" id="text-orgc102d81">
<p>
As a general rule, you can obtain different level of extraction based on the kind of devices and the patches applied.<br />
</p>
</div>

<div id="outline-container-org6f01326" class="outline-6">
<h6 id="org6f01326">Physical acquisition</h6>
<div class="outline-text-6" id="text-org6f01326">
<p>
Our goal is generally to obtain a physical, non invasive acquisition, which means we would use an exploit to obtain an image of the entire phone without phisically handling the phone (except for the insertion of a cable).<br />
</p>

<p>
On most Samsung, encryption is done using full disk encryption (and not file based encryption). In this cases, we can change the boot loader (the part of the OS responsible of starting the OS) to and &ldquo;engineering bootloader&rdquo; to be able to access the trusted zone of the phone and obtain the encryption keys.<br />
</p>

<p>
These engeneering bootloader must be signed by Samsung and be valid for the phone.<br />
</p>
</div>
</div>

<div id="outline-container-org1436dc1" class="outline-6">
<h6 id="org1436dc1">Logical acquisition</h6>
<div class="outline-text-6" id="text-org1436dc1">
<p>
When a physical acquisition is not possible we rely on smaller acquisitions or, sometimes, simple logical acquisitions (which means that we only take what is available to us as non-root users).<br />
</p>

<p>
Whit a logical aquisition we can tipically obtain native applications data but not third parti applications data (whatsapp, facebook etc.)<br />
</p>
</div>
</div>

<div id="outline-container-org12c1b57" class="outline-6">
<h6 id="org12c1b57">Partial filesystem aquisition</h6>
<div class="outline-text-6" id="text-org12c1b57">
<p>
Since we are mostly interested on third party applications, sometimes we might try some (software) invasive method to get those data, for example to downgrade the application to have a viable exploit to make.<br />
Take note that <b>this method is invasive</b>, since you are changing the state of the phone to do it.<br />
</p>
</div>
</div>

<div id="outline-container-orgcc67a50" class="outline-6">
<h6 id="orgcc67a50">Invasive acquisition</h6>
<div class="outline-text-6" id="text-orgcc67a50">
<p>
You can remove the chip from the device and try to analyze it, but most of the times nowadays you will get encrypted data.<br />
This is still a <span class="underline">great option for IoT devices</span>.<br />
</p>

<p>
On some android devices you can also simply remove external memories (sd cards and sim cards), even though sim cards don&rsquo;t contain much infos except for carrier informations.<br />
</p>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org055ad08" class="outline-3">
<h3 id="org055ad08">Tool analysis: Autopsy</h3>
<div class="outline-text-3" id="text-org055ad08">
<p>
Autopsy is an open source tool to analyze machines (calls itself the &ldquo;premium forensic platform&rdquo;).<br />
For mobile forensics, it will need an image to analyze.<br />
It is centralized (in the organization, not globally), so its users users can share content.<br />
</p>
</div>

<div id="outline-container-orgf78e87e" class="outline-4">
<h4 id="orgf78e87e">Android analysis on Autopsy</h4>
<div class="outline-text-4" id="text-orgf78e87e">
<p>
Once you unzip the android file, you get two files:<br />
</p>
<ul class="org-ul">
<li>a 30gb file containing the dump of the rom memory of the file. That&rsquo;s a full <span class="underline">filesystem</span> image, with the partitioning schema included.<br /></li>
<li>another 4mb file<br /></li>
</ul>

<p>
Let&rsquo;s analyze the image by, first, creating a <i>case</i> and adding our image to it. The type of source should be DiskImage (not LogicalFiles, since we have available a filesystem with partitions).<br />
</p>

<p>
Then you select the timezone (UTC, we guess) and the tools to run on the image.<br />
The tools we are going to use are:<br />
</p>
<ul class="org-ul">
<li>File Type identification<br /></li>
<li>Extension mismatch detector<br /></li>
<li>Embedded files extractor (allows to check if there is a file containing other files, like zip files, documents with images etc.)<br /></li>
<li>Picture analyzer (checks internal metadata for pictures)<br /></li>
<li>Android analyzer<br /></li>
</ul>

<p>
The tool will start adding the data source to your case.<br />
</p>
</div>

<div id="outline-container-org8598cd2" class="outline-5">
<h5 id="org8598cd2">Image extraction</h5>
<div class="outline-text-5" id="text-org8598cd2">
<p>
The extraction of the image must usually be done with commercial tools, like UFED for PC (from Cellebrite).<br />
The same company makes a commercial analyzer (like autopsy, but a bit more advanced).<br />
</p>

<p>
Image extraction on a locked phone is based on an exploit, and as usual this is risky.<br />
That&rsquo;s why you should know what are the risks of each image extraction method (there are multiple, that can extract different kinds of informations)<br />
</p>
</div>
</div>

<div id="outline-container-org8d77297" class="outline-5">
<h5 id="org8d77297">Image Analysis</h5>
<div class="outline-text-5" id="text-org8d77297">
<p>
After having loaded the image, you can look at its contents through Autopsy.<br />
You can see, by looking at the data sources, the huge number of partitions in an android device.<br />
The most important ones are:<br />
</p>
<ul class="org-ul">
<li>The <b>system partition</b>, where the stock OS resides.<br />
<ul class="org-ul">
<li>The app folder in the system partition contains pre-installed apps, in particular the apk files to run them.<br /></li>
<li>This partition should not contain user data (unless the phone is rooted)<br /></li>
<li>The <code>build.prop</code> file in the root of the file system contains the the properties of this build of android (like versions).<br /></li>
</ul></li>
<li>The userdata partition.<br />
<ul class="org-ul">
<li>Contains user data, settings, applications installed via the play store etc<br /></li>
<li>You have an app folder here too, containing the apk files of the  applications installed by the user.<br /></li>
<li>Under the data folder, we have a folder for each package (com.whatsapp, for example) and this folder is the only one to which the application can write data to.<br />
The data organization in this folder is highly dependant on the application.<br /></li>
</ul></li>
<li>The misc folder.<br />
<ul class="org-ul">
<li>Contains mainly network configurations, which can tell us more on the locations the target visited.<br /></li>
</ul></li>
</ul>

<p>
The results of the analysis are in the &ldquo;Extracted Content&rdquo; submenu.<br />
We can see:<br />
</p>
<ul class="org-ul">
<li>Call logs, organized as databases, with cellular calls, facebook calls etc.<br />
To extract its contents we need to understand how its data is organized.<br /></li>
<li>Messages, organized in databases too, with SMS, whatsapp messages etc.<br />
These might not be all the messages saved on the phone! These are just the ones the tool was able to extract.<br /></li>
<li>Pictures, which can also be cached pictures.<br /></li>
<li>The list of installed applications<br /></li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-orgcfe8226" class="outline-3">
<h3 id="orgcfe8226">Android analysis with Physical analyzer (commercial tool)</h3>
<div class="outline-text-3" id="text-orgcfe8226">
<p>
Built for mobile only.<br />
</p>

<p>
The unpacking of the image is done through layers: you start with the filesystem layer, then go to the volume layer, then to the file layer<br />
</p>

<p>
The difference with Autopsy is the number of applications data layouts recognized.<br />
For example, if we go to look at the call logs, they are many more than the ones we found in Autopsy, because it was able to fetch calls from more applications.<br />
You can also see the file where the information was extracted from, and the specific point of extraction.<br />
</p>

<p>
When you see a red number next to an entry you know that number of items where deleted by the user and recovered by the tool.<br />
</p>

<p>
Through the timeline, you can see every item with the timestamp of the last access/creation, with a graph showing the usage of the phone based on them.<br />
</p>

<p>
Moreover, you can also see the account tokens used in the phone (potentially having access to the account).<br />
</p>
</div>

<div id="outline-container-orga73ef8a" class="outline-4">
<h4 id="orga73ef8a">How to have a forensically resiliant phone&#xa0;&#xa0;&#xa0;<span class="tag"><span class="in_class_question">in_class_question</span></span></h4>
<div class="outline-text-4" id="text-orga73ef8a">
<p>
To have a forensically resiliant phone, the producer must limit the costumers on their use and set restrictions on the things they can do with the phone.<br />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org4757802" class="outline-2">
<h2 id="org4757802">Malware Analysis&#xa0;&#xa0;&#xa0;<span class="tag"><span class="missing_informations">missing_informations</span>&#xa0;<span class="guest_lecture">guest_lecture</span></span></h2>
<div class="outline-text-2" id="text-org4757802">
<p>
There are two kinds of analysis (we will use both in the demo):<br />
</p>
<ul class="org-ul">
<li>static:<br />
The code is not executed; Avoids malicious behaviors, but might be slow.<br /></li>
<li>dynamic:<br />
Usually made through a debugger: You run the program and check its runtime behavior.<br />
<span class="underline">Can</span> be much faster than static analysis (but the malware might recognize it&rsquo;s being dynamically analyzed, or be dormiant)<br /></li>
</ul>

<p>
The <b>best strategy is doing both</b>.<br />
</p>

<p>
On windows, register entries are used by malwares to get persistency and stay hidden.<br />
</p>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
litigation can be translated in italian with &ldquo;fatto in esame&rdquo;.<br />
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2">2</a></sup> <div class="footpara"><p class="footpara">
Skewness, in this context, can be read as <b>asymmetry</b><br />
</p></div></div>

<div class="footdef"><sup><a id="fn.3" class="footnum" href="#fnr.3">3</a></sup> <div class="footpara"><p class="footpara">
Basket market can be translated with &ldquo;vendita al dettaglio&rdquo; in Italian.<br />
</p></div></div>

<div class="footdef"><sup><a id="fn.4" class="footnum" href="#fnr.4">4</a></sup> <div class="footpara"><p class="footpara">
If you have followed the course &ldquo;Foundations of Operation Research&rdquo;, you are already familiar with this concept.<br />
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Tancredi Covioli</p>
<p class="date">Created: 2021-06-10 gio 16:19</p>
</div>
</body>
</html>
